{
  "hash": "6e9de541f7eaf53266d4424d2acaea90",
  "result": {
    "engine": "jupyter",
    "markdown": "---\njupyter: python3\n---\n\n::: {#40ddf0ed .cell execution_count=1}\n``` {.python .cell-code}\nimport fastcore.all as fc\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg\">ModuleNotFoundError</span>                       Traceback (most recent call last)\nCell <span class=\"ansi-green-fg\">In[1], line 1</span>\n<span class=\"ansi-green-fg\">----&gt; 1</span> <span style=\"font-weight:bold;color:rgb(0,135,0)\">import</span> <span style=\"font-weight:bold;color:rgb(0,0,255)\">fastcore</span><span style=\"font-weight:bold;color:rgb(0,0,255)\">.</span><span style=\"font-weight:bold;color:rgb(0,0,255)\">all</span> <span style=\"font-weight:bold;color:rgb(0,135,0)\">as</span> <span style=\"font-weight:bold;color:rgb(0,0,255)\">fc</span>\n\n<span class=\"ansi-red-fg\">ModuleNotFoundError</span>: No module named 'fastcore'</pre>\n```\n:::\n\n:::\n:::\n\n\n::: {#35f15066 .cell execution_count=2}\n``` {.python .cell-code}\nurl = 'https://s3.amazonaws.com/fast-ai-imagelocal/camvid.tgz'\n```\n:::\n\n\n::: {#ed20cb10 .cell execution_count=3}\n``` {.python .cell-code}\nfrom pathlib import Path\nimport pickle,gzip, math,os,time,shutil,matplotlib as mpl,matplotlib.pyplot as plt\nfrom glob import glob\nfrom torch import tensor\n\nfrom miniai.datasets import *\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg\">ModuleNotFoundError</span>                       Traceback (most recent call last)\nCell <span class=\"ansi-green-fg\">In[3], line 6</span>\n<span class=\"ansi-green-fg ansi-bold\">      3</span> <span style=\"font-weight:bold;color:rgb(0,135,0)\">from</span> <span style=\"font-weight:bold;color:rgb(0,0,255)\">glob</span> <span style=\"font-weight:bold;color:rgb(0,135,0)\">import</span> glob\n<span class=\"ansi-green-fg ansi-bold\">      4</span> <span style=\"font-weight:bold;color:rgb(0,135,0)\">from</span> <span style=\"font-weight:bold;color:rgb(0,0,255)\">torch</span> <span style=\"font-weight:bold;color:rgb(0,135,0)\">import</span> tensor\n<span class=\"ansi-green-fg\">----&gt; 6</span> <span style=\"font-weight:bold;color:rgb(0,135,0)\">from</span> <span style=\"font-weight:bold;color:rgb(0,0,255)\">miniai</span><span style=\"font-weight:bold;color:rgb(0,0,255)\">.</span><span style=\"font-weight:bold;color:rgb(0,0,255)\">datasets</span> <span style=\"font-weight:bold;color:rgb(0,135,0)\">import</span> <span style=\"color:rgb(98,98,98)\">*</span>\n\nFile <span class=\"ansi-green-fg\">~/work/blog/notes/deeplearning_for_coders_p2/miniai/datasets.py:8</span>\n<span class=\"ansi-green-fg ansi-bold\">      6</span> <span style=\"font-weight:bold;color:rgb(0,135,0)\">from</span> <span style=\"font-weight:bold;color:rgb(0,0,255)\">operator</span> <span style=\"font-weight:bold;color:rgb(0,135,0)\">import</span> itemgetter\n<span class=\"ansi-green-fg ansi-bold\">      7</span> <span style=\"font-weight:bold;color:rgb(0,135,0)\">from</span> <span style=\"font-weight:bold;color:rgb(0,0,255)\">itertools</span> <span style=\"font-weight:bold;color:rgb(0,135,0)\">import</span> zip_longest\n<span class=\"ansi-green-fg\">----&gt; 8</span> <span style=\"font-weight:bold;color:rgb(0,135,0)\">import</span> <span style=\"font-weight:bold;color:rgb(0,0,255)\">fastcore</span><span style=\"font-weight:bold;color:rgb(0,0,255)\">.</span><span style=\"font-weight:bold;color:rgb(0,0,255)\">all</span> <span style=\"font-weight:bold;color:rgb(0,135,0)\">as</span> <span style=\"font-weight:bold;color:rgb(0,0,255)\">fc</span>\n<span class=\"ansi-green-fg ansi-bold\">     10</span> <span style=\"font-weight:bold;color:rgb(0,135,0)\">from</span> <span style=\"font-weight:bold;color:rgb(0,0,255)\">torch</span><span style=\"font-weight:bold;color:rgb(0,0,255)\">.</span><span style=\"font-weight:bold;color:rgb(0,0,255)\">utils</span><span style=\"font-weight:bold;color:rgb(0,0,255)\">.</span><span style=\"font-weight:bold;color:rgb(0,0,255)\">data</span> <span style=\"font-weight:bold;color:rgb(0,135,0)\">import</span> default_collate\n<span class=\"ansi-green-fg ansi-bold\">     12</span> <span style=\"font-weight:bold;color:rgb(0,135,0)\">from</span> <span style=\"font-weight:bold;color:rgb(0,0,255)\">.</span><span style=\"font-weight:bold;color:rgb(0,0,255)\">training</span> <span style=\"font-weight:bold;color:rgb(0,135,0)\">import</span> <span style=\"color:rgb(98,98,98)\">*</span>\n\n<span class=\"ansi-red-fg\">ModuleNotFoundError</span>: No module named 'fastcore'</pre>\n```\n:::\n\n:::\n:::\n\n\n::: {#d88d430a .cell execution_count=4}\n``` {.python .cell-code}\npath = Path('data/camvid')\n```\n:::\n\n\n::: {#703ee450 .cell execution_count=5}\n``` {.python .cell-code}\nif not path.exists():\n    path_tgz = fc.urlsave(url, 'data')\n    shutil.unpack_archive(str(path_tgz), 'data')\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg\">NameError</span>                                 Traceback (most recent call last)\nCell <span class=\"ansi-green-fg\">In[5], line 2</span>\n<span class=\"ansi-green-fg ansi-bold\">      1</span> <span style=\"font-weight:bold;color:rgb(0,135,0)\">if</span> <span style=\"font-weight:bold;color:rgb(175,0,255)\">not</span> path<span style=\"color:rgb(98,98,98)\">.</span>exists():\n<span class=\"ansi-green-fg\">----&gt; 2</span>     path_tgz <span style=\"color:rgb(98,98,98)\">=</span> <span class=\"ansi-yellow-bg\">fc</span><span style=\"color:rgb(98,98,98)\">.</span>urlsave(url, <span style=\"color:rgb(175,0,0)\">'</span><span style=\"color:rgb(175,0,0)\">data</span><span style=\"color:rgb(175,0,0)\">'</span>)\n<span class=\"ansi-green-fg ansi-bold\">      3</span>     shutil<span style=\"color:rgb(98,98,98)\">.</span>unpack_archive(<span style=\"color:rgb(0,135,0)\">str</span>(path_tgz), <span style=\"color:rgb(175,0,0)\">'</span><span style=\"color:rgb(175,0,0)\">data</span><span style=\"color:rgb(175,0,0)\">'</span>)\n\n<span class=\"ansi-red-fg\">NameError</span>: name 'fc' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\n::: {#0b3e66b7 .cell execution_count=6}\n``` {.python .cell-code}\npath.ls()\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg\">AttributeError</span>                            Traceback (most recent call last)\nCell <span class=\"ansi-green-fg\">In[6], line 1</span>\n<span class=\"ansi-green-fg\">----&gt; 1</span> <span class=\"ansi-yellow-bg\">path</span><span style=\"color:rgb(98,98,98)\" class=\"ansi-yellow-bg\">.</span><span class=\"ansi-yellow-bg\">ls</span>()\n\n<span class=\"ansi-red-fg\">AttributeError</span>: 'PosixPath' object has no attribute 'ls'</pre>\n```\n:::\n\n:::\n:::\n\n\n::: {#e5649a9c .cell execution_count=7}\n``` {.python .cell-code}\npath_lbl = path/'labels'\npath_img = path/'images'\n```\n:::\n\n\n::: {#c2b4dd1c .cell execution_count=8}\n``` {.python .cell-code}\nfnames = glob(str(path_img/'*.png'))\nlbl_names = glob(str(path_lbl/'*.png'))\n```\n:::\n\n\n::: {#3c599ab0 .cell execution_count=9}\n``` {.python .cell-code}\nimg_f = Path(fnames[0])\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg\">IndexError</span>                                Traceback (most recent call last)\nCell <span class=\"ansi-green-fg\">In[9], line 1</span>\n<span class=\"ansi-green-fg\">----&gt; 1</span> img_f <span style=\"color:rgb(98,98,98)\">=</span> Path(<span class=\"ansi-yellow-bg\">fnames</span><span class=\"ansi-yellow-bg\">[</span><span style=\"color:rgb(98,98,98)\" class=\"ansi-yellow-bg\">0</span><span class=\"ansi-yellow-bg\">]</span>)\n\n<span class=\"ansi-red-fg\">IndexError</span>: list index out of range</pre>\n```\n:::\n\n:::\n:::\n\n\n::: {#64b5dedb .cell execution_count=10}\n``` {.python .cell-code}\nimg_f\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg\">NameError</span>                                 Traceback (most recent call last)\nCell <span class=\"ansi-green-fg\">In[10], line 1</span>\n<span class=\"ansi-green-fg\">----&gt; 1</span> <span class=\"ansi-yellow-bg\">img_f</span>\n\n<span class=\"ansi-red-fg\">NameError</span>: name 'img_f' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\n::: {#1ea8b004 .cell execution_count=11}\n``` {.python .cell-code}\nfrom torchvision.io import read_image\n```\n:::\n\n\n::: {#bc9a2cc7 .cell execution_count=12}\n``` {.python .cell-code}\nimg = read_image(str(img_f))/255\nimg.shape\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg\">NameError</span>                                 Traceback (most recent call last)\nCell <span class=\"ansi-green-fg\">In[12], line 1</span>\n<span class=\"ansi-green-fg\">----&gt; 1</span> img <span style=\"color:rgb(98,98,98)\">=</span> read_image(<span style=\"color:rgb(0,135,0)\">str</span>(<span class=\"ansi-yellow-bg\">img_f</span>))<span style=\"color:rgb(98,98,98)\">/</span><span style=\"color:rgb(98,98,98)\">255</span>\n<span class=\"ansi-green-fg ansi-bold\">      2</span> img<span style=\"color:rgb(98,98,98)\">.</span>shape\n\n<span class=\"ansi-red-fg\">NameError</span>: name 'img_f' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\n::: {#315d3eb6 .cell execution_count=13}\n``` {.python .cell-code}\nshow_image(img);\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg\">NameError</span>                                 Traceback (most recent call last)\nCell <span class=\"ansi-green-fg\">In[13], line 1</span>\n<span class=\"ansi-green-fg\">----&gt; 1</span> <span class=\"ansi-yellow-bg\">show_image</span>(img);\n\n<span class=\"ansi-red-fg\">NameError</span>: name 'show_image' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\n::: {#b232cd11 .cell execution_count=14}\n``` {.python .cell-code}\nshow_image((img*2).clamp_max(1));\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg\">NameError</span>                                 Traceback (most recent call last)\nCell <span class=\"ansi-green-fg\">In[14], line 1</span>\n<span class=\"ansi-green-fg\">----&gt; 1</span> <span class=\"ansi-yellow-bg\">show_image</span>((img<span style=\"color:rgb(98,98,98)\">*</span><span style=\"color:rgb(98,98,98)\">2</span>)<span style=\"color:rgb(98,98,98)\">.</span>clamp_max(<span style=\"color:rgb(98,98,98)\">1</span>));\n\n<span class=\"ansi-red-fg\">NameError</span>: name 'show_image' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\n::: {#77b3951f .cell execution_count=15}\n``` {.python .cell-code}\nshow_image((img.clamp(0.001,0.999).logit()+1).sigmoid());\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg\">NameError</span>                                 Traceback (most recent call last)\nCell <span class=\"ansi-green-fg\">In[15], line 1</span>\n<span class=\"ansi-green-fg\">----&gt; 1</span> <span class=\"ansi-yellow-bg\">show_image</span>((img<span style=\"color:rgb(98,98,98)\">.</span>clamp(<span style=\"color:rgb(98,98,98)\">0.001</span>,<span style=\"color:rgb(98,98,98)\">0.999</span>)<span style=\"color:rgb(98,98,98)\">.</span>logit()<span style=\"color:rgb(98,98,98)\">+</span><span style=\"color:rgb(98,98,98)\">1</span>)<span style=\"color:rgb(98,98,98)\">.</span>sigmoid());\n\n<span class=\"ansi-red-fg\">NameError</span>: name 'show_image' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\n::: {#ef337b2e .cell execution_count=16}\n``` {.python .cell-code}\ndef get_y_fn(x): return path_lbl/f'{x.stem}_P{x.suffix}'\n```\n:::\n\n\n::: {#90bb646a .cell execution_count=17}\n``` {.python .cell-code}\nmask_f = get_y_fn(img_f)\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg\">NameError</span>                                 Traceback (most recent call last)\nCell <span class=\"ansi-green-fg\">In[17], line 1</span>\n<span class=\"ansi-green-fg\">----&gt; 1</span> mask_f <span style=\"color:rgb(98,98,98)\">=</span> get_y_fn(<span class=\"ansi-yellow-bg\">img_f</span>)\n\n<span class=\"ansi-red-fg\">NameError</span>: name 'img_f' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\n::: {#5bfb670f .cell execution_count=18}\n``` {.python .cell-code}\nmask = read_image(str(mask_f))\nmask.shape\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg\">NameError</span>                                 Traceback (most recent call last)\nCell <span class=\"ansi-green-fg\">In[18], line 1</span>\n<span class=\"ansi-green-fg\">----&gt; 1</span> mask <span style=\"color:rgb(98,98,98)\">=</span> read_image(<span style=\"color:rgb(0,135,0)\">str</span>(<span class=\"ansi-yellow-bg\">mask_f</span>))\n<span class=\"ansi-green-fg ansi-bold\">      2</span> mask<span style=\"color:rgb(98,98,98)\">.</span>shape\n\n<span class=\"ansi-red-fg\">NameError</span>: name 'mask_f' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\n::: {#1ac72c87 .cell execution_count=19}\n``` {.python .cell-code}\nshow_image(mask, cmap='tab20');\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg\">NameError</span>                                 Traceback (most recent call last)\nCell <span class=\"ansi-green-fg\">In[19], line 1</span>\n<span class=\"ansi-green-fg\">----&gt; 1</span> <span class=\"ansi-yellow-bg\">show_image</span>(mask, cmap<span style=\"color:rgb(98,98,98)\">=</span><span style=\"color:rgb(175,0,0)\">'</span><span style=\"color:rgb(175,0,0)\">tab20</span><span style=\"color:rgb(175,0,0)\">'</span>);\n\n<span class=\"ansi-red-fg\">NameError</span>: name 'show_image' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\n::: {#c042f040 .cell execution_count=20}\n``` {.python .cell-code}\nax = show_image(img)\nshow_image(mask, ax=ax, cmap='tab20', alpha=0.5);\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg\">NameError</span>                                 Traceback (most recent call last)\nCell <span class=\"ansi-green-fg\">In[20], line 1</span>\n<span class=\"ansi-green-fg\">----&gt; 1</span> ax <span style=\"color:rgb(98,98,98)\">=</span> <span class=\"ansi-yellow-bg\">show_image</span>(img)\n<span class=\"ansi-green-fg ansi-bold\">      2</span> show_image(mask, ax<span style=\"color:rgb(98,98,98)\">=</span>ax, cmap<span style=\"color:rgb(98,98,98)\">=</span><span style=\"color:rgb(175,0,0)\">'</span><span style=\"color:rgb(175,0,0)\">tab20</span><span style=\"color:rgb(175,0,0)\">'</span>, alpha<span style=\"color:rgb(98,98,98)\">=</span><span style=\"color:rgb(98,98,98)\">0.5</span>);\n\n<span class=\"ansi-red-fg\">NameError</span>: name 'show_image' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\n::: {#5e9e9c89 .cell execution_count=21}\n``` {.python .cell-code}\ncodes = (path/'codes.txt').read_text().splitlines(False)\n' '.join(codes)\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg\">FileNotFoundError</span>                         Traceback (most recent call last)\nCell <span class=\"ansi-green-fg\">In[21], line 1</span>\n<span class=\"ansi-green-fg\">----&gt; 1</span> codes <span style=\"color:rgb(98,98,98)\">=</span> <span class=\"ansi-yellow-bg\">(</span><span class=\"ansi-yellow-bg\">path</span><span style=\"color:rgb(98,98,98)\" class=\"ansi-yellow-bg\">/</span><span style=\"color:rgb(175,0,0)\" class=\"ansi-yellow-bg\">'</span><span style=\"color:rgb(175,0,0)\" class=\"ansi-yellow-bg\">codes.txt</span><span style=\"color:rgb(175,0,0)\" class=\"ansi-yellow-bg\">'</span><span class=\"ansi-yellow-bg\">)</span><span style=\"color:rgb(98,98,98)\" class=\"ansi-yellow-bg\">.</span><span class=\"ansi-yellow-bg\">read_text</span><span class=\"ansi-yellow-bg\">(</span><span class=\"ansi-yellow-bg\">)</span><span style=\"color:rgb(98,98,98)\">.</span>splitlines(<span style=\"font-weight:bold;color:rgb(0,135,0)\">False</span>)\n<span class=\"ansi-green-fg ansi-bold\">      2</span> <span style=\"color:rgb(175,0,0)\">'</span><span style=\"color:rgb(175,0,0)\"> </span><span style=\"color:rgb(175,0,0)\">'</span><span style=\"color:rgb(98,98,98)\">.</span>join(codes)\n\nFile <span class=\"ansi-green-fg\">/usr/lib/python3.10/pathlib.py:1134</span>, in <span class=\"ansi-cyan-fg\">Path.read_text</span><span class=\"ansi-blue-fg\">(self, encoding, errors)</span>\n<span class=\"ansi-green-fg ansi-bold\">   1130</span> <span style=\"font-style:italic;color:rgb(175,0,0)\">\"\"\"</span>\n<span class=\"ansi-green-fg ansi-bold\">   1131</span> <span style=\"font-style:italic;color:rgb(175,0,0)\">Open the file in text mode, read it, and close the file.</span>\n<span class=\"ansi-green-fg ansi-bold\">   1132</span> <span style=\"font-style:italic;color:rgb(175,0,0)\">\"\"\"</span>\n<span class=\"ansi-green-fg ansi-bold\">   1133</span> encoding <span style=\"color:rgb(98,98,98)\">=</span> io<span style=\"color:rgb(98,98,98)\">.</span>text_encoding(encoding)\n<span class=\"ansi-green-fg\">-&gt; 1134</span> <span style=\"font-weight:bold;color:rgb(0,135,0)\">with</span> <span style=\"color:rgb(0,135,0)\" class=\"ansi-yellow-bg\">self</span><span style=\"color:rgb(98,98,98)\" class=\"ansi-yellow-bg\">.</span><span class=\"ansi-yellow-bg\">open</span><span class=\"ansi-yellow-bg\">(</span><span class=\"ansi-yellow-bg\">mode</span><span style=\"color:rgb(98,98,98)\" class=\"ansi-yellow-bg\">=</span><span style=\"color:rgb(175,0,0)\" class=\"ansi-yellow-bg\">'</span><span style=\"color:rgb(175,0,0)\" class=\"ansi-yellow-bg\">r</span><span style=\"color:rgb(175,0,0)\" class=\"ansi-yellow-bg\">'</span><span class=\"ansi-yellow-bg\">,</span><span class=\"ansi-yellow-bg\"> </span><span class=\"ansi-yellow-bg\">encoding</span><span style=\"color:rgb(98,98,98)\" class=\"ansi-yellow-bg\">=</span><span class=\"ansi-yellow-bg\">encoding</span><span class=\"ansi-yellow-bg\">,</span><span class=\"ansi-yellow-bg\"> </span><span class=\"ansi-yellow-bg\">errors</span><span style=\"color:rgb(98,98,98)\" class=\"ansi-yellow-bg\">=</span><span class=\"ansi-yellow-bg\">errors</span><span class=\"ansi-yellow-bg\">)</span> <span style=\"font-weight:bold;color:rgb(0,135,0)\">as</span> f:\n<span class=\"ansi-green-fg ansi-bold\">   1135</span>     <span style=\"font-weight:bold;color:rgb(0,135,0)\">return</span> f<span style=\"color:rgb(98,98,98)\">.</span>read()\n\nFile <span class=\"ansi-green-fg\">/usr/lib/python3.10/pathlib.py:1119</span>, in <span class=\"ansi-cyan-fg\">Path.open</span><span class=\"ansi-blue-fg\">(self, mode, buffering, encoding, errors, newline)</span>\n<span class=\"ansi-green-fg ansi-bold\">   1117</span> <span style=\"font-weight:bold;color:rgb(0,135,0)\">if</span> <span style=\"color:rgb(175,0,0)\">\"</span><span style=\"color:rgb(175,0,0)\">b</span><span style=\"color:rgb(175,0,0)\">\"</span> <span style=\"font-weight:bold;color:rgb(175,0,255)\">not</span> <span style=\"font-weight:bold;color:rgb(175,0,255)\">in</span> mode:\n<span class=\"ansi-green-fg ansi-bold\">   1118</span>     encoding <span style=\"color:rgb(98,98,98)\">=</span> io<span style=\"color:rgb(98,98,98)\">.</span>text_encoding(encoding)\n<span class=\"ansi-green-fg\">-&gt; 1119</span> <span style=\"font-weight:bold;color:rgb(0,135,0)\">return</span> <span style=\"color:rgb(0,135,0)\" class=\"ansi-yellow-bg\">self</span><span style=\"color:rgb(98,98,98)\" class=\"ansi-yellow-bg\">.</span><span class=\"ansi-yellow-bg\">_accessor</span><span style=\"color:rgb(98,98,98)\" class=\"ansi-yellow-bg\">.</span><span class=\"ansi-yellow-bg\">open</span><span class=\"ansi-yellow-bg\">(</span><span style=\"color:rgb(0,135,0)\" class=\"ansi-yellow-bg\">self</span><span class=\"ansi-yellow-bg\">,</span><span class=\"ansi-yellow-bg\"> </span><span class=\"ansi-yellow-bg\">mode</span><span class=\"ansi-yellow-bg\">,</span><span class=\"ansi-yellow-bg\"> </span><span class=\"ansi-yellow-bg\">buffering</span><span class=\"ansi-yellow-bg\">,</span><span class=\"ansi-yellow-bg\"> </span><span class=\"ansi-yellow-bg\">encoding</span><span class=\"ansi-yellow-bg\">,</span><span class=\"ansi-yellow-bg\"> </span><span class=\"ansi-yellow-bg\">errors</span><span class=\"ansi-yellow-bg\">,</span>\n<span class=\"ansi-green-fg ansi-bold\">   1120</span> <span class=\"ansi-yellow-bg\">                           </span><span class=\"ansi-yellow-bg\">newline</span><span class=\"ansi-yellow-bg\">)</span>\n\n<span class=\"ansi-red-fg\">FileNotFoundError</span>: [Errno 2] No such file or directory: 'data/camvid/codes.txt'</pre>\n```\n:::\n\n:::\n:::\n\n\n::: {#b85e6967 .cell execution_count=22}\n``` {.python .cell-code}\ncodes[26]\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg\">NameError</span>                                 Traceback (most recent call last)\nCell <span class=\"ansi-green-fg\">In[22], line 1</span>\n<span class=\"ansi-green-fg\">----&gt; 1</span> <span class=\"ansi-yellow-bg\">codes</span>[<span style=\"color:rgb(98,98,98)\">26</span>]\n\n<span class=\"ansi-red-fg\">NameError</span>: name 'codes' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\n::: {#176583a7 .cell execution_count=23}\n``` {.python .cell-code}\nsrc_size = tensor(mask.shape[1:])\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg\">NameError</span>                                 Traceback (most recent call last)\nCell <span class=\"ansi-green-fg\">In[23], line 1</span>\n<span class=\"ansi-green-fg\">----&gt; 1</span> src_size <span style=\"color:rgb(98,98,98)\">=</span> tensor(<span class=\"ansi-yellow-bg\">mask</span><span style=\"color:rgb(98,98,98)\">.</span>shape[<span style=\"color:rgb(98,98,98)\">1</span>:])\n\n<span class=\"ansi-red-fg\">NameError</span>: name 'mask' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\n::: {#13002d06 .cell execution_count=24}\n``` {.python .cell-code}\nvalids = set((path/'valid.txt').read_text().splitlines(False))\nlist(valids)[:5]\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg\">FileNotFoundError</span>                         Traceback (most recent call last)\nCell <span class=\"ansi-green-fg\">In[24], line 1</span>\n<span class=\"ansi-green-fg\">----&gt; 1</span> valids <span style=\"color:rgb(98,98,98)\">=</span> <span style=\"color:rgb(0,135,0)\">set</span>(<span class=\"ansi-yellow-bg\">(</span><span class=\"ansi-yellow-bg\">path</span><span style=\"color:rgb(98,98,98)\" class=\"ansi-yellow-bg\">/</span><span style=\"color:rgb(175,0,0)\" class=\"ansi-yellow-bg\">'</span><span style=\"color:rgb(175,0,0)\" class=\"ansi-yellow-bg\">valid.txt</span><span style=\"color:rgb(175,0,0)\" class=\"ansi-yellow-bg\">'</span><span class=\"ansi-yellow-bg\">)</span><span style=\"color:rgb(98,98,98)\" class=\"ansi-yellow-bg\">.</span><span class=\"ansi-yellow-bg\">read_text</span><span class=\"ansi-yellow-bg\">(</span><span class=\"ansi-yellow-bg\">)</span><span style=\"color:rgb(98,98,98)\">.</span>splitlines(<span style=\"font-weight:bold;color:rgb(0,135,0)\">False</span>))\n<span class=\"ansi-green-fg ansi-bold\">      2</span> <span style=\"color:rgb(0,135,0)\">list</span>(valids)[:<span style=\"color:rgb(98,98,98)\">5</span>]\n\nFile <span class=\"ansi-green-fg\">/usr/lib/python3.10/pathlib.py:1134</span>, in <span class=\"ansi-cyan-fg\">Path.read_text</span><span class=\"ansi-blue-fg\">(self, encoding, errors)</span>\n<span class=\"ansi-green-fg ansi-bold\">   1130</span> <span style=\"font-style:italic;color:rgb(175,0,0)\">\"\"\"</span>\n<span class=\"ansi-green-fg ansi-bold\">   1131</span> <span style=\"font-style:italic;color:rgb(175,0,0)\">Open the file in text mode, read it, and close the file.</span>\n<span class=\"ansi-green-fg ansi-bold\">   1132</span> <span style=\"font-style:italic;color:rgb(175,0,0)\">\"\"\"</span>\n<span class=\"ansi-green-fg ansi-bold\">   1133</span> encoding <span style=\"color:rgb(98,98,98)\">=</span> io<span style=\"color:rgb(98,98,98)\">.</span>text_encoding(encoding)\n<span class=\"ansi-green-fg\">-&gt; 1134</span> <span style=\"font-weight:bold;color:rgb(0,135,0)\">with</span> <span style=\"color:rgb(0,135,0)\" class=\"ansi-yellow-bg\">self</span><span style=\"color:rgb(98,98,98)\" class=\"ansi-yellow-bg\">.</span><span class=\"ansi-yellow-bg\">open</span><span class=\"ansi-yellow-bg\">(</span><span class=\"ansi-yellow-bg\">mode</span><span style=\"color:rgb(98,98,98)\" class=\"ansi-yellow-bg\">=</span><span style=\"color:rgb(175,0,0)\" class=\"ansi-yellow-bg\">'</span><span style=\"color:rgb(175,0,0)\" class=\"ansi-yellow-bg\">r</span><span style=\"color:rgb(175,0,0)\" class=\"ansi-yellow-bg\">'</span><span class=\"ansi-yellow-bg\">,</span><span class=\"ansi-yellow-bg\"> </span><span class=\"ansi-yellow-bg\">encoding</span><span style=\"color:rgb(98,98,98)\" class=\"ansi-yellow-bg\">=</span><span class=\"ansi-yellow-bg\">encoding</span><span class=\"ansi-yellow-bg\">,</span><span class=\"ansi-yellow-bg\"> </span><span class=\"ansi-yellow-bg\">errors</span><span style=\"color:rgb(98,98,98)\" class=\"ansi-yellow-bg\">=</span><span class=\"ansi-yellow-bg\">errors</span><span class=\"ansi-yellow-bg\">)</span> <span style=\"font-weight:bold;color:rgb(0,135,0)\">as</span> f:\n<span class=\"ansi-green-fg ansi-bold\">   1135</span>     <span style=\"font-weight:bold;color:rgb(0,135,0)\">return</span> f<span style=\"color:rgb(98,98,98)\">.</span>read()\n\nFile <span class=\"ansi-green-fg\">/usr/lib/python3.10/pathlib.py:1119</span>, in <span class=\"ansi-cyan-fg\">Path.open</span><span class=\"ansi-blue-fg\">(self, mode, buffering, encoding, errors, newline)</span>\n<span class=\"ansi-green-fg ansi-bold\">   1117</span> <span style=\"font-weight:bold;color:rgb(0,135,0)\">if</span> <span style=\"color:rgb(175,0,0)\">\"</span><span style=\"color:rgb(175,0,0)\">b</span><span style=\"color:rgb(175,0,0)\">\"</span> <span style=\"font-weight:bold;color:rgb(175,0,255)\">not</span> <span style=\"font-weight:bold;color:rgb(175,0,255)\">in</span> mode:\n<span class=\"ansi-green-fg ansi-bold\">   1118</span>     encoding <span style=\"color:rgb(98,98,98)\">=</span> io<span style=\"color:rgb(98,98,98)\">.</span>text_encoding(encoding)\n<span class=\"ansi-green-fg\">-&gt; 1119</span> <span style=\"font-weight:bold;color:rgb(0,135,0)\">return</span> <span style=\"color:rgb(0,135,0)\" class=\"ansi-yellow-bg\">self</span><span style=\"color:rgb(98,98,98)\" class=\"ansi-yellow-bg\">.</span><span class=\"ansi-yellow-bg\">_accessor</span><span style=\"color:rgb(98,98,98)\" class=\"ansi-yellow-bg\">.</span><span class=\"ansi-yellow-bg\">open</span><span class=\"ansi-yellow-bg\">(</span><span style=\"color:rgb(0,135,0)\" class=\"ansi-yellow-bg\">self</span><span class=\"ansi-yellow-bg\">,</span><span class=\"ansi-yellow-bg\"> </span><span class=\"ansi-yellow-bg\">mode</span><span class=\"ansi-yellow-bg\">,</span><span class=\"ansi-yellow-bg\"> </span><span class=\"ansi-yellow-bg\">buffering</span><span class=\"ansi-yellow-bg\">,</span><span class=\"ansi-yellow-bg\"> </span><span class=\"ansi-yellow-bg\">encoding</span><span class=\"ansi-yellow-bg\">,</span><span class=\"ansi-yellow-bg\"> </span><span class=\"ansi-yellow-bg\">errors</span><span class=\"ansi-yellow-bg\">,</span>\n<span class=\"ansi-green-fg ansi-bold\">   1120</span> <span class=\"ansi-yellow-bg\">                           </span><span class=\"ansi-yellow-bg\">newline</span><span class=\"ansi-yellow-bg\">)</span>\n\n<span class=\"ansi-red-fg\">FileNotFoundError</span>: [Errno 2] No such file or directory: 'data/camvid/valid.txt'</pre>\n```\n:::\n\n:::\n:::\n\n\n::: {#c815c0cd .cell execution_count=25}\n``` {.python .cell-code}\nimg = read_image(str(img_f))\nimg.shape\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg\">NameError</span>                                 Traceback (most recent call last)\nCell <span class=\"ansi-green-fg\">In[25], line 1</span>\n<span class=\"ansi-green-fg\">----&gt; 1</span> img <span style=\"color:rgb(98,98,98)\">=</span> read_image(<span style=\"color:rgb(0,135,0)\">str</span>(<span class=\"ansi-yellow-bg\">img_f</span>))\n<span class=\"ansi-green-fg ansi-bold\">      2</span> img<span style=\"color:rgb(98,98,98)\">.</span>shape\n\n<span class=\"ansi-red-fg\">NameError</span>: name 'img_f' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\n::: {#2fb1592f .cell execution_count=26}\n``` {.python .cell-code}\nfrom fastai.vision.all import *\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg\">ModuleNotFoundError</span>                       Traceback (most recent call last)\nCell <span class=\"ansi-green-fg\">In[26], line 1</span>\n<span class=\"ansi-green-fg\">----&gt; 1</span> <span style=\"font-weight:bold;color:rgb(0,135,0)\">from</span> <span style=\"font-weight:bold;color:rgb(0,0,255)\">fastai</span><span style=\"font-weight:bold;color:rgb(0,0,255)\">.</span><span style=\"font-weight:bold;color:rgb(0,0,255)\">vision</span><span style=\"font-weight:bold;color:rgb(0,0,255)\">.</span><span style=\"font-weight:bold;color:rgb(0,0,255)\">all</span> <span style=\"font-weight:bold;color:rgb(0,135,0)\">import</span> <span style=\"color:rgb(98,98,98)\">*</span>\n\n<span class=\"ansi-red-fg\">ModuleNotFoundError</span>: No module named 'fastai'</pre>\n```\n:::\n\n:::\n:::\n\n\n::: {#e2aedb11 .cell execution_count=27}\n``` {.python .cell-code}\nbs = 8\n```\n:::\n\n\n::: {#4ee46caa .cell execution_count=28}\n``` {.python .cell-code}\ndblock = DataBlock(blocks=(ImageBlock(), MaskBlock(codes=codes)),\n                   splitter=FuncSplitter(lambda o: o.name in valids),\n                   get_y=get_y_fn,\n                   item_tfms=Resize((720//4,960//4)))\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg\">NameError</span>                                 Traceback (most recent call last)\nCell <span class=\"ansi-green-fg\">In[28], line 1</span>\n<span class=\"ansi-green-fg\">----&gt; 1</span> dblock <span style=\"color:rgb(98,98,98)\">=</span> <span class=\"ansi-yellow-bg\">DataBlock</span>(blocks<span style=\"color:rgb(98,98,98)\">=</span>(ImageBlock(), MaskBlock(codes<span style=\"color:rgb(98,98,98)\">=</span>codes)),\n<span class=\"ansi-green-fg ansi-bold\">      2</span>                    splitter<span style=\"color:rgb(98,98,98)\">=</span>FuncSplitter(<span style=\"font-weight:bold;color:rgb(0,135,0)\">lambda</span> o: o<span style=\"color:rgb(98,98,98)\">.</span>name <span style=\"font-weight:bold;color:rgb(175,0,255)\">in</span> valids),\n<span class=\"ansi-green-fg ansi-bold\">      3</span>                    get_y<span style=\"color:rgb(98,98,98)\">=</span>get_y_fn,\n<span class=\"ansi-green-fg ansi-bold\">      4</span>                    item_tfms<span style=\"color:rgb(98,98,98)\">=</span>Resize((<span style=\"color:rgb(98,98,98)\">720</span><span style=\"color:rgb(98,98,98)\">/</span><span style=\"color:rgb(98,98,98)\">/</span><span style=\"color:rgb(98,98,98)\">4</span>,<span style=\"color:rgb(98,98,98)\">960</span><span style=\"color:rgb(98,98,98)\">/</span><span style=\"color:rgb(98,98,98)\">/</span><span style=\"color:rgb(98,98,98)\">4</span>)))\n\n<span class=\"ansi-red-fg\">NameError</span>: name 'DataBlock' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\n::: {#cc6e15fe .cell execution_count=29}\n``` {.python .cell-code}\nimg_files = get_image_files(path/\"images\")\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg\">NameError</span>                                 Traceback (most recent call last)\nCell <span class=\"ansi-green-fg\">In[29], line 1</span>\n<span class=\"ansi-green-fg\">----&gt; 1</span> img_files <span style=\"color:rgb(98,98,98)\">=</span> <span class=\"ansi-yellow-bg\">get_image_files</span>(path<span style=\"color:rgb(98,98,98)\">/</span><span style=\"color:rgb(175,0,0)\">\"</span><span style=\"color:rgb(175,0,0)\">images</span><span style=\"color:rgb(175,0,0)\">\"</span>)\n\n<span class=\"ansi-red-fg\">NameError</span>: name 'get_image_files' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\n::: {#dc02fd87 .cell execution_count=30}\n``` {.python .cell-code}\ndls = dblock.dataloaders(img_files, path=path, num_workers=4)\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg\">NameError</span>                                 Traceback (most recent call last)\nCell <span class=\"ansi-green-fg\">In[30], line 1</span>\n<span class=\"ansi-green-fg\">----&gt; 1</span> dls <span style=\"color:rgb(98,98,98)\">=</span> <span class=\"ansi-yellow-bg\">dblock</span><span style=\"color:rgb(98,98,98)\">.</span>dataloaders(img_files, path<span style=\"color:rgb(98,98,98)\">=</span>path, num_workers<span style=\"color:rgb(98,98,98)\">=</span><span style=\"color:rgb(98,98,98)\">4</span>)\n\n<span class=\"ansi-red-fg\">NameError</span>: name 'dblock' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\n::: {#f15ac682 .cell execution_count=31}\n``` {.python .cell-code}\nxb,yb = next(iter(dls.train))\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg\">NameError</span>                                 Traceback (most recent call last)\nCell <span class=\"ansi-green-fg\">In[31], line 1</span>\n<span class=\"ansi-green-fg\">----&gt; 1</span> xb,yb <span style=\"color:rgb(98,98,98)\">=</span> <span style=\"color:rgb(0,135,0)\">next</span>(<span style=\"color:rgb(0,135,0)\">iter</span>(<span class=\"ansi-yellow-bg\">dls</span><span style=\"color:rgb(98,98,98)\">.</span>train))\n\n<span class=\"ansi-red-fg\">NameError</span>: name 'dls' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\n::: {#35b7be3d .cell execution_count=32}\n``` {.python .cell-code}\nxb.shape\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg\">NameError</span>                                 Traceback (most recent call last)\nCell <span class=\"ansi-green-fg\">In[32], line 1</span>\n<span class=\"ansi-green-fg\">----&gt; 1</span> <span class=\"ansi-yellow-bg\">xb</span><span style=\"color:rgb(98,98,98)\">.</span>shape\n\n<span class=\"ansi-red-fg\">NameError</span>: name 'xb' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\n::: {#312b4ea2 .cell execution_count=33}\n``` {.python .cell-code}\ndls.show_batch()\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg\">NameError</span>                                 Traceback (most recent call last)\nCell <span class=\"ansi-green-fg\">In[33], line 1</span>\n<span class=\"ansi-green-fg\">----&gt; 1</span> <span class=\"ansi-yellow-bg\">dls</span><span style=\"color:rgb(98,98,98)\">.</span>show_batch()\n\n<span class=\"ansi-red-fg\">NameError</span>: name 'dls' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\n::: {#bf1438d2 .cell execution_count=34}\n``` {.python .cell-code}\nname2id = {v:k for k,v in enumerate(codes)}\nvoid_code = name2id['Void']\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg\">NameError</span>                                 Traceback (most recent call last)\nCell <span class=\"ansi-green-fg\">In[34], line 1</span>\n<span class=\"ansi-green-fg\">----&gt; 1</span> name2id <span style=\"color:rgb(98,98,98)\">=</span> {v:k <span style=\"font-weight:bold;color:rgb(0,135,0)\">for</span> k,v <span style=\"font-weight:bold;color:rgb(175,0,255)\">in</span> <span style=\"color:rgb(0,135,0)\">enumerate</span>(<span class=\"ansi-yellow-bg\">codes</span>)}\n<span class=\"ansi-green-fg ansi-bold\">      2</span> void_code <span style=\"color:rgb(98,98,98)\">=</span> name2id[<span style=\"color:rgb(175,0,0)\">'</span><span style=\"color:rgb(175,0,0)\">Void</span><span style=\"color:rgb(175,0,0)\">'</span>]\n\n<span class=\"ansi-red-fg\">NameError</span>: name 'codes' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\n::: {#8ef88189 .cell execution_count=35}\n``` {.python .cell-code}\ndef acc_camvid(input, target):\n    target = target.squeeze(1)\n    mask = target != void_code\n    return (input.argmax(dim=1)[mask]==target[mask]).float().mean()\n```\n:::\n\n\n::: {#d9e2a933 .cell execution_count=36}\n``` {.python .cell-code}\nlearn = unet_learner(dls, resnet18, metrics=acc_camvid, pretrained=False)\nlearn.fit_one_cycle(8)\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg\">NameError</span>                                 Traceback (most recent call last)\nCell <span class=\"ansi-green-fg\">In[36], line 1</span>\n<span class=\"ansi-green-fg\">----&gt; 1</span> learn <span style=\"color:rgb(98,98,98)\">=</span> <span class=\"ansi-yellow-bg\">unet_learner</span>(dls, resnet18, metrics<span style=\"color:rgb(98,98,98)\">=</span>acc_camvid, pretrained<span style=\"color:rgb(98,98,98)\">=</span><span style=\"font-weight:bold;color:rgb(0,135,0)\">False</span>)\n<span class=\"ansi-green-fg ansi-bold\">      2</span> learn<span style=\"color:rgb(98,98,98)\">.</span>fit_one_cycle(<span style=\"color:rgb(98,98,98)\">8</span>)\n\n<span class=\"ansi-red-fg\">NameError</span>: name 'unet_learner' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\n::: {#7ab56ecf .cell execution_count=37}\n``` {.python .cell-code}\nlearn.show_results(max_n=3, figsize=(7,8))\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg\">NameError</span>                                 Traceback (most recent call last)\nCell <span class=\"ansi-green-fg\">In[37], line 1</span>\n<span class=\"ansi-green-fg\">----&gt; 1</span> <span class=\"ansi-yellow-bg\">learn</span><span style=\"color:rgb(98,98,98)\">.</span>show_results(max_n<span style=\"color:rgb(98,98,98)\">=</span><span style=\"color:rgb(98,98,98)\">3</span>, figsize<span style=\"color:rgb(98,98,98)\">=</span>(<span style=\"color:rgb(98,98,98)\">7</span>,<span style=\"color:rgb(98,98,98)\">8</span>))\n\n<span class=\"ansi-red-fg\">NameError</span>: name 'learn' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\n::: {#049b3577 .cell execution_count=38}\n``` {.python .cell-code}\nlearn = unet_learner(dls, resnet18, metrics=acc_camvid)\nlearn.fine_tune(8)\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg\">NameError</span>                                 Traceback (most recent call last)\nCell <span class=\"ansi-green-fg\">In[38], line 1</span>\n<span class=\"ansi-green-fg\">----&gt; 1</span> learn <span style=\"color:rgb(98,98,98)\">=</span> <span class=\"ansi-yellow-bg\">unet_learner</span>(dls, resnet18, metrics<span style=\"color:rgb(98,98,98)\">=</span>acc_camvid)\n<span class=\"ansi-green-fg ansi-bold\">      2</span> learn<span style=\"color:rgb(98,98,98)\">.</span>fine_tune(<span style=\"color:rgb(98,98,98)\">8</span>)\n\n<span class=\"ansi-red-fg\">NameError</span>: name 'unet_learner' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\n::: {#f943567e .cell execution_count=39}\n``` {.python .cell-code}\nlearn.show_results(max_n=3, figsize=(7,8))\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg\">NameError</span>                                 Traceback (most recent call last)\nCell <span class=\"ansi-green-fg\">In[39], line 1</span>\n<span class=\"ansi-green-fg\">----&gt; 1</span> <span class=\"ansi-yellow-bg\">learn</span><span style=\"color:rgb(98,98,98)\">.</span>show_results(max_n<span style=\"color:rgb(98,98,98)\">=</span><span style=\"color:rgb(98,98,98)\">3</span>, figsize<span style=\"color:rgb(98,98,98)\">=</span>(<span style=\"color:rgb(98,98,98)\">7</span>,<span style=\"color:rgb(98,98,98)\">8</span>))\n\n<span class=\"ansi-red-fg\">NameError</span>: name 'learn' is not defined</pre>\n```\n:::\n\n:::\n:::\n\n\n",
    "supporting": [
      "segmentation_files"
    ],
    "filters": [],
    "includes": {}
  }
}