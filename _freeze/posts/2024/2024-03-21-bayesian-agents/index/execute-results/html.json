{
  "hash": "84291f9942cfba7238e55c4feeed67ba",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ndate: 2024-03-21\ntitle: \"Bayesian Agent\"\nsubtitle: \"Agent Based Modeling With MESA\" \ncategories: [ABM, Agent Based Modeling, Baysian Game Theory, Game Theory, Signaling Games]\ndraft: true\n---\n\n## The Sherif Dillema Game\n\nThe Sherif Dillema is a considered a signaling game in game theory\nHowever is is also a fairly simple example of a Bayesain game\n\n\nThis game is defined by (N,A,T,p,u), where:\n\n- N = {Suspect, Sheriff} \n- ASuspect = {Shoot, Not} ,\n- ASheriff = {Shoot, Not}\n- TSuspect = {Criminal, Civilian} , \n- TSheriff = {\\*} \n- pCriminal = p , \n- pCivilian = (1 - p) \n\nIt is assumed that the payoffs, u, are given as follows:\n\n|                  | Sheriff's action | Shoot  | Not   |\n|------------------|------------------|--------|-------|\n| Suspect's action | Shoot            | 0, 0   | 2, -2 |\n| Suspect's action | Not              | -2, -1 | -1,1  |\n: Payoffs for \"Criminal\" {#tbl-criminal}\n\n|                  | Sheriff's action | Shoot    | Not      |\n|------------------|------------------|----------|----------|\n| Suspect's action | Shoot            | (-3, -1) | (-1, -2) |\n| Suspect's action | Not              | (-2, -1) | (0, 0)   |\n: Payoffs for \"Civilian\" {#tbl-civilian}\n\n\n\nThe following Python code uses the MESA framework to simulate a Bayesian game known as the Sheriff's Dilemma. It defines agents with different roles (Sheriff and Suspect) and types (Criminal or Civilian for the suspect). Each agent makes decisions based on its beliefs and the payoff structure defined for the game. The game tracks the actions, payoffs, and beliefs of each player and simulates multiple iterations of the game.\n\n::: {#437ea46f .cell execution_count=1}\n``` {.python .cell-code}\nimport random\nimport mesa\nfrom mesa import Agent, Model, DataCollector\nfrom mesa.time import RandomActivation\n\nclass SheriffAgent(Agent):\n    \"\"\"Agent representing the Sheriff.\"\"\"\n    def __init__(self, unique_id, model):\n        super().__init__(unique_id, model)\n        self.action = None\n    \n    def step(self):\n        # Sheriff decides based on belief about the suspect's type\n        belief_criminal = self.model.belief_criminal\n        # Simple decision rule based on belief (could be improved with a more sophisticated strategy)\n        self.action = \"Shoot\" if belief_criminal > 0.5 else \"Not\"\n\nclass SuspectAgent(Agent):\n    \"\"\"Agent representing the Suspect.\"\"\"\n    def __init__(self, unique_id, model, suspect_type):\n        super().__init__(unique_id, model)\n        self.suspect_type = suspect_type\n        self.action = None\n    \n    def step(self):\n        # Suspect's decision could be based on its type or a strategy considering the sheriff's action\n        # For simplicity, let's say criminals are more likely to shoot\n        if self.suspect_type == \"Criminal\":\n            self.action = \"Shoot\" if random.random() > 0.5 else \"Not\"\n        else:\n            self.action = \"Not\"  # Civilians are less likely to shoot\n\nclass SheriffsDilemma(Model):\n    \"\"\"A model for the Sheriff's Dilemma game.\"\"\"\n    def __init__(self, p_criminal):\n        super().__init__()\n        self.schedule = mesa.time.RandomActivation(self)\n        self.suspect_type = \"Criminal\" if random.random() < p_criminal else \"Civilian\"\n        self.belief_criminal = p_criminal  # Initial belief about suspect being a criminal\n        self.payoff = None\n        # Create agents\n        sheriff = SheriffAgent(1, self)\n        suspect = SuspectAgent(2, self, self.suspect_type)\n        self.schedule.add(sheriff)\n        self.schedule.add(suspect)\n        \n        self.datacollector = mesa.DataCollector(\n          model_reporters={\"Payoff\":\"payoff\"},\n          agent_reporters={\"Action\":\"action\"}\n            )\n            \n\n    \n    def step(self):\n        self.datacollector.collect(self)\n        self.schedule.step()\n        \n        # After both agents have taken their actions, calculate payoffs based on the table provided\n        sheriff_action = [agent for agent in self.schedule.agents if isinstance(agent, SheriffAgent)][0].action\n        suspect_action = [agent for agent in self.schedule.agents if isinstance(agent, SuspectAgent)][0].action\n        suspect_type = self.suspect_type\n\n        payoff_matrix = {\n            (\"Criminal\", \"Shoot\", \"Shoot\"): (0, 0),\n            (\"Criminal\", \"Shoot\", \"Not\"): (2, -2),\n            (\"Criminal\", \"Not\", \"Shoot\"): (-2, -1),\n            (\"Criminal\", \"Not\", \"Not\"): (-1, 1),\n            (\"Civilian\", \"Shoot\", \"Shoot\"): (-3, -1),\n            (\"Civilian\", \"Shoot\", \"Not\"): (-1, -2),\n            (\"Civilian\", \"Not\", \"Shoot\"): (-2, -1),\n            (\"Civilian\", \"Not\", \"Not\"): (0, 0),\n        }\n        self.payoff = payoff_matrix[(suspect_type, suspect_action, sheriff_action)]\n        print(f\"Round results - Suspect Type: {suspect_type}, Sheriff Action: {sheriff_action}, Suspect Action: {suspect_action}, Payoffs: {self.payoff}\")\n\n# Example of running a single iteration\nmodel = SheriffsDilemma(p_criminal=0.5)\nfor i in range(100):\n    model.step()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRound results - Suspect Type: Criminal, Sheriff Action: Not, Suspect Action: Shoot, Payoffs: (2, -2)\nRound results - Suspect Type: Criminal, Sheriff Action: Not, Suspect Action: Not, Payoffs: (-1, 1)\nRound results - Suspect Type: Criminal, Sheriff Action: Not, Suspect Action: Not, Payoffs: (-1, 1)\nRound results - Suspect Type: Criminal, Sheriff Action: Not, Suspect Action: Shoot, Payoffs: (2, -2)\nRound results - Suspect Type: Criminal, Sheriff Action: Not, Suspect Action: Shoot, Payoffs: (2, -2)\nRound results - Suspect Type: Criminal, Sheriff Action: Not, Suspect Action: Not, Payoffs: (-1, 1)\nRound results - Suspect Type: Criminal, Sheriff Action: Not, Suspect Action: Shoot, Payoffs: (2, -2)\nRound results - Suspect Type: Criminal, Sheriff Action: Not, Suspect Action: Shoot, Payoffs: (2, -2)\nRound results - Suspect Type: Criminal, Sheriff Action: Not, Suspect Action: Not, Payoffs: (-1, 1)\nRound results - Suspect Type: Criminal, Sheriff Action: Not, Suspect Action: Shoot, Payoffs: (2, -2)\nRound results - Suspect Type: Criminal, Sheriff Action: Not, Suspect Action: Shoot, Payoffs: (2, -2)\nRound results - Suspect Type: Criminal, Sheriff Action: Not, Suspect Action: Not, Payoffs: (-1, 1)\nRound results - Suspect Type: Criminal, Sheriff Action: Not, Suspect Action: Shoot, Payoffs: (2, -2)\nRound results - Suspect Type: Criminal, Sheriff Action: Not, Suspect Action: Not, Payoffs: (-1, 1)\nRound results - Suspect Type: Criminal, Sheriff Action: Not, Suspect Action: Not, Payoffs: (-1, 1)\nRound results - Suspect Type: Criminal, Sheriff Action: Not, Suspect Action: Not, Payoffs: (-1, 1)\nRound results - Suspect Type: Criminal, Sheriff Action: Not, Suspect Action: Shoot, Payoffs: (2, -2)\nRound results - Suspect Type: Criminal, Sheriff Action: Not, Suspect Action: Not, Payoffs: (-1, 1)\nRound results - Suspect Type: Criminal, Sheriff Action: Not, Suspect Action: Shoot, Payoffs: (2, -2)\nRound results - Suspect Type: Criminal, Sheriff Action: Not, Suspect Action: Shoot, Payoffs: (2, -2)\nRound results - Suspect Type: Criminal, Sheriff Action: Not, Suspect Action: Shoot, Payoffs: (2, -2)\nRound results - Suspect Type: Criminal, Sheriff Action: Not, Suspect Action: Not, Payoffs: (-1, 1)\nRound results - Suspect Type: Criminal, Sheriff Action: Not, Suspect Action: Shoot, Payoffs: (2, -2)\nRound results - Suspect Type: Criminal, Sheriff Action: Not, Suspect Action: Shoot, Payoffs: (2, -2)\nRound results - Suspect Type: Criminal, Sheriff Action: Not, Suspect Action: Shoot, Payoffs: (2, -2)\nRound results - Suspect Type: Criminal, Sheriff Action: Not, Suspect Action: Shoot, Payoffs: (2, -2)\nRound results - Suspect Type: Criminal, Sheriff Action: Not, Suspect Action: Not, Payoffs: (-1, 1)\nRound results - Suspect Type: Criminal, Sheriff Action: Not, Suspect Action: Not, Payoffs: (-1, 1)\nRound results - Suspect Type: Criminal, Sheriff Action: Not, Suspect Action: Not, Payoffs: (-1, 1)\nRound results - Suspect Type: Criminal, Sheriff Action: Not, Suspect Action: Not, Payoffs: (-1, 1)\nRound results - Suspect Type: Criminal, Sheriff Action: Not, Suspect Action: Not, Payoffs: (-1, 1)\nRound results - Suspect Type: Criminal, Sheriff Action: Not, Suspect Action: Shoot, Payoffs: (2, -2)\nRound results - Suspect Type: Criminal, Sheriff Action: Not, Suspect Action: Shoot, Payoffs: (2, -2)\nRound results - Suspect Type: Criminal, Sheriff Action: Not, Suspect Action: Shoot, Payoffs: (2, -2)\nRound results - Suspect Type: Criminal, Sheriff Action: Not, Suspect Action: Not, Payoffs: (-1, 1)\nRound results - Suspect Type: Criminal, Sheriff Action: Not, Suspect Action: Shoot, Payoffs: (2, -2)\nRound results - Suspect Type: Criminal, Sheriff Action: Not, Suspect Action: Shoot, Payoffs: (2, -2)\nRound results - Suspect Type: Criminal, Sheriff Action: Not, Suspect Action: Not, Payoffs: (-1, 1)\nRound results - Suspect Type: Criminal, Sheriff Action: Not, Suspect Action: Shoot, Payoffs: (2, -2)\nRound results - Suspect Type: Criminal, Sheriff Action: Not, Suspect Action: Shoot, Payoffs: (2, -2)\nRound results - Suspect Type: Criminal, Sheriff Action: Not, Suspect Action: Not, Payoffs: (-1, 1)\nRound results - Suspect Type: Criminal, Sheriff Action: Not, Suspect Action: Not, Payoffs: (-1, 1)\nRound results - Suspect Type: Criminal, Sheriff Action: Not, Suspect Action: Shoot, Payoffs: (2, -2)\nRound results - Suspect Type: Criminal, Sheriff Action: Not, Suspect Action: Not, Payoffs: (-1, 1)\nRound results - Suspect Type: Criminal, Sheriff Action: Not, Suspect Action: Not, Payoffs: (-1, 1)\nRound results - Suspect Type: Criminal, Sheriff Action: Not, Suspect Action: Shoot, Payoffs: (2, -2)\nRound results - Suspect Type: Criminal, Sheriff Action: Not, Suspect Action: Shoot, Payoffs: (2, -2)\nRound results - Suspect Type: Criminal, Sheriff Action: Not, Suspect Action: Not, Payoffs: (-1, 1)\nRound results - Suspect Type: Criminal, Sheriff Action: Not, Suspect Action: Not, Payoffs: (-1, 1)\nRound results - Suspect Type: Criminal, Sheriff Action: Not, Suspect Action: Not, Payoffs: (-1, 1)\nRound results - Suspect Type: Criminal, Sheriff Action: Not, Suspect Action: Not, Payoffs: (-1, 1)\nRound results - Suspect Type: Criminal, Sheriff Action: Not, Suspect Action: Shoot, Payoffs: (2, -2)\nRound results - Suspect Type: Criminal, Sheriff Action: Not, Suspect Action: Shoot, Payoffs: (2, -2)\nRound results - Suspect Type: Criminal, Sheriff Action: Not, Suspect Action: Not, Payoffs: (-1, 1)\nRound results - Suspect Type: Criminal, Sheriff Action: Not, Suspect Action: Not, Payoffs: (-1, 1)\nRound results - Suspect Type: Criminal, Sheriff Action: Not, Suspect Action: Not, Payoffs: (-1, 1)\nRound results - Suspect Type: Criminal, Sheriff Action: Not, Suspect Action: Not, Payoffs: (-1, 1)\nRound results - Suspect Type: Criminal, Sheriff Action: Not, Suspect Action: Not, Payoffs: (-1, 1)\nRound results - Suspect Type: Criminal, Sheriff Action: Not, Suspect Action: Not, Payoffs: (-1, 1)\nRound results - Suspect Type: Criminal, Sheriff Action: Not, Suspect Action: Not, Payoffs: (-1, 1)\nRound results - Suspect Type: Criminal, Sheriff Action: Not, Suspect Action: Shoot, Payoffs: (2, -2)\nRound results - Suspect Type: Criminal, Sheriff Action: Not, Suspect Action: Not, Payoffs: (-1, 1)\nRound results - Suspect Type: Criminal, Sheriff Action: Not, Suspect Action: Shoot, Payoffs: (2, -2)\nRound results - Suspect Type: Criminal, Sheriff Action: Not, Suspect Action: Not, Payoffs: (-1, 1)\nRound results - Suspect Type: Criminal, Sheriff Action: Not, Suspect Action: Shoot, Payoffs: (2, -2)\nRound results - Suspect Type: Criminal, Sheriff Action: Not, Suspect Action: Shoot, Payoffs: (2, -2)\nRound results - Suspect Type: Criminal, Sheriff Action: Not, Suspect Action: Shoot, Payoffs: (2, -2)\nRound results - Suspect Type: Criminal, Sheriff Action: Not, Suspect Action: Shoot, Payoffs: (2, -2)\nRound results - Suspect Type: Criminal, Sheriff Action: Not, Suspect Action: Not, Payoffs: (-1, 1)\nRound results - Suspect Type: Criminal, Sheriff Action: Not, Suspect Action: Shoot, Payoffs: (2, -2)\nRound results - Suspect Type: Criminal, Sheriff Action: Not, Suspect Action: Shoot, Payoffs: (2, -2)\nRound results - Suspect Type: Criminal, Sheriff Action: Not, Suspect Action: Not, Payoffs: (-1, 1)\nRound results - Suspect Type: Criminal, Sheriff Action: Not, Suspect Action: Not, Payoffs: (-1, 1)\nRound results - Suspect Type: Criminal, Sheriff Action: Not, Suspect Action: Not, Payoffs: (-1, 1)\nRound results - Suspect Type: Criminal, Sheriff Action: Not, Suspect Action: Not, Payoffs: (-1, 1)\nRound results - Suspect Type: Criminal, Sheriff Action: Not, Suspect Action: Shoot, Payoffs: (2, -2)\nRound results - Suspect Type: Criminal, Sheriff Action: Not, Suspect Action: Not, Payoffs: (-1, 1)\nRound results - Suspect Type: Criminal, Sheriff Action: Not, Suspect Action: Not, Payoffs: (-1, 1)\nRound results - Suspect Type: Criminal, Sheriff Action: Not, Suspect Action: Not, Payoffs: (-1, 1)\nRound results - Suspect Type: Criminal, Sheriff Action: Not, Suspect Action: Shoot, Payoffs: (2, -2)\nRound results - Suspect Type: Criminal, Sheriff Action: Not, Suspect Action: Not, Payoffs: (-1, 1)\nRound results - Suspect Type: Criminal, Sheriff Action: Not, Suspect Action: Not, Payoffs: (-1, 1)\nRound results - Suspect Type: Criminal, Sheriff Action: Not, Suspect Action: Shoot, Payoffs: (2, -2)\nRound results - Suspect Type: Criminal, Sheriff Action: Not, Suspect Action: Not, Payoffs: (-1, 1)\nRound results - Suspect Type: Criminal, Sheriff Action: Not, Suspect Action: Not, Payoffs: (-1, 1)\nRound results - Suspect Type: Criminal, Sheriff Action: Not, Suspect Action: Shoot, Payoffs: (2, -2)\nRound results - Suspect Type: Criminal, Sheriff Action: Not, Suspect Action: Not, Payoffs: (-1, 1)\nRound results - Suspect Type: Criminal, Sheriff Action: Not, Suspect Action: Shoot, Payoffs: (2, -2)\nRound results - Suspect Type: Criminal, Sheriff Action: Not, Suspect Action: Shoot, Payoffs: (2, -2)\nRound results - Suspect Type: Criminal, Sheriff Action: Not, Suspect Action: Not, Payoffs: (-1, 1)\nRound results - Suspect Type: Criminal, Sheriff Action: Not, Suspect Action: Shoot, Payoffs: (2, -2)\nRound results - Suspect Type: Criminal, Sheriff Action: Not, Suspect Action: Not, Payoffs: (-1, 1)\nRound results - Suspect Type: Criminal, Sheriff Action: Not, Suspect Action: Not, Payoffs: (-1, 1)\nRound results - Suspect Type: Criminal, Sheriff Action: Not, Suspect Action: Not, Payoffs: (-1, 1)\nRound results - Suspect Type: Criminal, Sheriff Action: Not, Suspect Action: Shoot, Payoffs: (2, -2)\nRound results - Suspect Type: Criminal, Sheriff Action: Not, Suspect Action: Shoot, Payoffs: (2, -2)\nRound results - Suspect Type: Criminal, Sheriff Action: Not, Suspect Action: Shoot, Payoffs: (2, -2)\nRound results - Suspect Type: Criminal, Sheriff Action: Not, Suspect Action: Not, Payoffs: (-1, 1)\nRound results - Suspect Type: Criminal, Sheriff Action: Not, Suspect Action: Shoot, Payoffs: (2, -2)\nRound results - Suspect Type: Criminal, Sheriff Action: Not, Suspect Action: Not, Payoffs: (-1, 1)\n```\n:::\n:::\n\n\n::: {#c0b78344 .cell execution_count=2}\n``` {.python .cell-code}\nmvars = model.datacollector.get_model_vars_dataframe()\nmvars\n# Plot the Gini coefficient over time\n#g = sns.lineplot(data=gini)\n#g.set(title=\"Gini Coefficient over Time\", ylabel=\"Gini Coefficient\");\n\n```\n\n::: {.cell-output .cell-output-display execution_count=2}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Payoff</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>None</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>(2, -2)</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>(-1, 1)</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>(-1, 1)</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>(2, -2)</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>95</th>\n      <td>(2, -2)</td>\n    </tr>\n    <tr>\n      <th>96</th>\n      <td>(2, -2)</td>\n    </tr>\n    <tr>\n      <th>97</th>\n      <td>(2, -2)</td>\n    </tr>\n    <tr>\n      <th>98</th>\n      <td>(-1, 1)</td>\n    </tr>\n    <tr>\n      <th>99</th>\n      <td>(2, -2)</td>\n    </tr>\n  </tbody>\n</table>\n<p>100 rows × 1 columns</p>\n</div>\n```\n:::\n:::\n\n\n::: {#5f96b308 .cell execution_count=3}\n``` {.python .cell-code}\navars = model.datacollector.get_agent_vars_dataframe()\navars\n```\n\n::: {.cell-output .cell-output-display execution_count=3}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th></th>\n      <th>Action</th>\n    </tr>\n    <tr>\n      <th>Step</th>\n      <th>AgentID</th>\n      <th></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th rowspan=\"2\" valign=\"top\">0</th>\n      <th>1</th>\n      <td>None</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>None</td>\n    </tr>\n    <tr>\n      <th rowspan=\"2\" valign=\"top\">1</th>\n      <th>2</th>\n      <td>Shoot</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>Not</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <th>2</th>\n      <td>Not</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <th>...</th>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>97</th>\n      <th>1</th>\n      <td>Not</td>\n    </tr>\n    <tr>\n      <th rowspan=\"2\" valign=\"top\">98</th>\n      <th>1</th>\n      <td>Not</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>Not</td>\n    </tr>\n    <tr>\n      <th rowspan=\"2\" valign=\"top\">99</th>\n      <th>1</th>\n      <td>Not</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>Shoot</td>\n    </tr>\n  </tbody>\n</table>\n<p>200 rows × 1 columns</p>\n</div>\n```\n:::\n:::\n\n\nThis code sets up the game and agents, then runs a single step (or iteration) of the game, printing out the results. The decision-making process for both the Sheriff and the Suspect is simplified and can be enhanced to implement more sophisticated strategies based on beliefs, historical actions, or game theory.\n\n\n1. I am not very happy with this yet. I also think that a second take using a public good game might be more interesting\n2. In this game we would like to know\n    1. the agent beliefs at the three stages: \n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdn.jsdelivr.net/npm/requirejs@2.3.6/require.min.js\" integrity=\"sha384-c9c+LnTbwQ3aujuU7ULEPVvgLs+Fn6fJUvIGTsuu1ZcCf11fiEubah0ttpca4ntM sha384-6V1/AdqZRWk1KAlWbKBlGhN7VG4iE/yAZcO6NZPMF8od0vukrvr0tg4qY6NSrItx\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js\" integrity=\"sha384-ZvpUoO/+PpLXR1lu4jmpXWu80pZlYUAfxl5NsBMWOEPSjUn/6Z/hRTt8+pR6L4N2\" crossorigin=\"anonymous\" data-relocate-top=\"true\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
      ]
    }
  }
}