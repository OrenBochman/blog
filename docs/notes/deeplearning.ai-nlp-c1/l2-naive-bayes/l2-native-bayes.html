<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.41">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Oren Bochman">
<meta name="description" content="Concepts, code snippets, and slide commentaries for this week’s lesson of the Course notes from the deeplearning.ai natural language programming specialization.">

<title>Oren Bochman's Blog – Classification &amp; Vector Spaces - Probability and Bayes’ Rule</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<link href="../../../favicon.ico" rel="icon">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script src="../../../site_libs/quarto-contrib/pseudocode-2.4.1/pseudocode.min.js"></script>
<link href="../../../site_libs/quarto-contrib/pseudocode-2.4.1/pseudocode.min.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>
<style>

      .quarto-title-block .quarto-title-banner {
        background-image: url(../../banner_black_3.jpg);
background-size: cover;
      }
</style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css">

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<meta name="twitter:title" content="Oren Bochman’s Blog - Classification &amp; Vector Spaces - Probability and Bayes’ Rule">
<meta name="twitter:description" content="Concepts, code snippets, and slide commentaries for this week’s lesson of the Course notes from the deeplearning.ai natural language programming specialization.">
<meta name="twitter:image" content="https://orenbochman.github.io/notes/deeplearning.ai-nlp-c1/l2-naive-bayes/course-banner.jpg">
<meta name="twitter:creator" content="@orenbochman">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-sidebar docked nav-fixed slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../../images/logo.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">Oren Bochman’s Blog</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-about" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">about</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-about">    
        <li>
    <a class="dropdown-item" href="../../../about.html">
 <span class="dropdown-text">About</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-notes" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">notes</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-notes">    
        <li>
    <a class="dropdown-item" href="../../../nlp.html">
 <span class="dropdown-text">NLP Specilization</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../dnn.html">
 <span class="dropdown-text">Neural Networks for Machine Learning</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../model-thinking.html">
 <span class="dropdown-text">Model Thinking</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../xai.html">
 <span class="dropdown-text">XAI</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../rl.html">
 <span class="dropdown-text">Reinforcement Learning</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../rhetoric.html">
 <span class="dropdown-text">Rhetoric</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../tfp.html">
 <span class="dropdown-text">TFP</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../ab-testing.html">
 <span class="dropdown-text">AB testing</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../cognitiveai.html">
 <span class="dropdown-text">Cognitive AI</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/orenbochman"> <i class="bi bi-twitter" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-bi-github" role="link" data-bs-toggle="dropdown" aria-expanded="false">
      <i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-bi-github">    
        <li>
    <a class="dropdown-item" href="https://github.com/OrenBochman/blog">
 <span class="dropdown-text">Source Code</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://github.com/OrenBochman/blog/issues">
 <span class="dropdown-text">Report a Bug</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item compact">
    <a class="nav-link" href="../../../index.xml"> <i class="bi bi-rss" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../archive.html"> <i class="bi bi-archive" role="img">
</i> 
<span class="menu-text">Archive</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Classification &amp; Vector Spaces - Probability and Bayes’ Rule</li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default toc-left page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Classification &amp; Vector Spaces - Probability and Bayes’ Rule</h1>
            <p class="subtitle lead">Course 1 of NLP Specialization</p>
                  <div>
        <div class="description">
          Concepts, code snippets, and slide commentaries for this week’s lesson of the Course notes from the deeplearning.ai natural language programming specialization.
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">NLP</div>
                <div class="quarto-category">Coursera</div>
                <div class="quarto-category">notes</div>
                <div class="quarto-category">deeplearning.ai</div>
                <div class="quarto-category">course notes</div>
                <div class="quarto-category">Conditional Probability</div>
                <div class="quarto-category">Bayes rule</div>
                <div class="quarto-category">Naïve Bayes</div>
                <div class="quarto-category">Laplace smoothing</div>
                <div class="quarto-category">Log-likelihood</div>
                <div class="quarto-category">classification</div>
                <div class="quarto-category">sentiment analysis task</div>
                <div class="quarto-category">bibliography</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Oren Bochman </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">Friday, October 23, 2020</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#naïve-bayes" id="toc-naïve-bayes" class="nav-link active" data-scroll-target="#naïve-bayes">Naïve Bayes</a></li>
  <li><a href="#introduction" id="toc-introduction" class="nav-link" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#research-questions" id="toc-research-questions" class="nav-link" data-scroll-target="#research-questions">Research questions</a></li>
  <li><a href="#definition-of-conditional-probability" id="toc-definition-of-conditional-probability" class="nav-link" data-scroll-target="#definition-of-conditional-probability">Definition of conditional probability</a></li>
  <li><a href="#bayes-rule" id="toc-bayes-rule" class="nav-link" data-scroll-target="#bayes-rule">Bayes’ rule</a></li>
  <li><a href="#laplace-smoothing" id="toc-laplace-smoothing" class="nav-link" data-scroll-target="#laplace-smoothing">Laplace smoothing</a>
  <ul class="collapse">
  <li><a href="#additive-smoothing" id="toc-additive-smoothing" class="nav-link" data-scroll-target="#additive-smoothing">Additive smoothing:</a></li>
  </ul></li>
  <li><a href="#ratio-of-probabilities" id="toc-ratio-of-probabilities" class="nav-link" data-scroll-target="#ratio-of-probabilities">Ratio of probabilities</a></li>
  <li><a href="#log-likelihood" id="toc-log-likelihood" class="nav-link" data-scroll-target="#log-likelihood">Log Likelihood</a></li>
  <li><a href="#training-naïve-bayes" id="toc-training-naïve-bayes" class="nav-link" data-scroll-target="#training-naïve-bayes">Training Naïve Bayes</a></li>
  <li><a href="#testing-naïve-bayes" id="toc-testing-naïve-bayes" class="nav-link" data-scroll-target="#testing-naïve-bayes">Testing Naïve Bayes</a></li>
  <li><a href="#naïve-bayes-applications" id="toc-naïve-bayes-applications" class="nav-link" data-scroll-target="#naïve-bayes-applications">Naïve Bayes Applications</a></li>
  <li><a href="#naïve-bayes-assumptions" id="toc-naïve-bayes-assumptions" class="nav-link" data-scroll-target="#naïve-bayes-assumptions">Naïve Bayes Assumptions</a></li>
  <li><a href="#resources" id="toc-resources" class="nav-link" data-scroll-target="#resources">resources:</a></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
    </div>
<!-- main -->
<main class="content quarto-banner-title-block page-columns page-full" id="quarto-document-content">





<p>Since I majored in Mathematics, I glossed over many details when I took the initial notes, since the course caters to all levels of students. When I migrated the notes from OneNotes to the web, I updated and reviewed the current course material and at times additional notes by <span class="citation" data-cites="chadha2020distilled">(<a href="#ref-chadha2020distilled" role="doc-biblioref">Chadha 2020</a>)</span> and <span class="citation" data-cites="Jelliti2020NLP">(<a href="#ref-Jelliti2020NLP" role="doc-biblioref"><strong>Jelliti2020NLP?</strong></a>)</span>. I have tried to add my own insights from other sources, books I read or others courses I have taken. ::: callout-note</p>
<section id="naïve-bayes" class="level1">
<h1>Naïve Bayes</h1>
<p><strong>Naïve Bayes</strong> is a probabilistic algorithm commonly used in <em>machine learning</em> for <em>classification</em> problems. It’s based on <em>Bayes’ theorem</em>, which is a fundamental concept in <em>probability theory</em>. Naïve Bayes assumes that all the features of the input data are independent of each other, which is why it’s called “naïve.” ::: The following two results are due to <span class="citation" data-cites="NIPS2001_7b7a53e2">(<a href="#ref-NIPS2001_7b7a53e2" role="doc-biblioref"><strong>NIPS2001_7b7a53e2?</strong></a>)</span> by way of <a href="https://en.wikipedia.org/wiki/Naive_Bayes_classifier#cite_note-pair-17">Naive_Bayes_classifier</a> wikipedia article. Another detail that can help you make sense of this lesson is the following result relating Naïve Bayes to Logistic Regression which we covered last week. In the case of discrete inputs (indicator or frequency features for discrete events), naive Bayes classifiers form a generative-discriminative pair with multinomial logistic regression classifiers: each naive Bayes classifier can be considered a way of fitting a probability model that optimizes the joint likelihood <span class="math inline">p (C,x)</span>, while logistic regression fits the same probability model to optimize the conditional <span class="math inline">p(C∣x)</span>. ::: callout-note ## Theorem — Naive Bayes classifiers on binary features are subsumed by logistic regression classifiers. ### Proof Consider a generic multiclass classification problem, with possible classes <span class="math inline">{\displaystyle Y\in \{1,...,n\}}</span> , then the (non-naive) Bayes classifier gives, by Bayes theorem: <span class="math display">
{ p(Y\mid X=x)={\text{softmax}}(\{\ln p(Y=k)+\ln p(X=x\mid Y=k)\}_{k})}
</span> The naive Bayes classifier gives <span class="math display">
{ {\text{softmax}}\left(\left\{\ln p(Y=k)+{\frac {1}{2}}\sum _{i}(a_{i,k}^{+}-a_{i,k}^{-})x_{i}+(a_{i,k}^{+}+a_{i,k}^{-})\right\}_{k}\right)}
</span> where <span class="math display">
{ a_{i,s}^{+}=\ln p(X_{i}=+1\mid Y=s);\quad a_{i,s}^{-}=\ln p(X_{i}=-1\mid Y=s)}
</span> This is exactly a logistic regression classifier. :::</p>
</section>
<section id="introduction" class="level1 page-columns page-full">
<h1>Introduction</h1>
<div class="page-columns page-full"><p> We start with a corpus of 20 tweets that can be categorized as having either <strong>positive</strong> <code>+</code> or <strong>negative</strong> <code>-</code> sentiment, but not both. ::: callout-caution</p><div class="no-row-height column-margin column-container"><img src="slide_020.png" class="img-fluid" alt="our corpus"></div></div>
</section>
<section id="research-questions" class="level1 page-columns page-full">
<h1>Research questions</h1>
<ul>
<li>How can we model our corpus using probability theory?</li>
<li>How can we infer the sentiment of a tweet based on our corpus ::: Since we can use the <code>sum rule</code>, <code>product rule</code> and <code>Bayes rule</code> which we shall cover shortly to manipulate probabilities we start by representing what we know about our corpus using probabilities. ## Probability of a randomly selected tweet’s sentiment</li>
<li>To calculate a <code>probability</code> of a certain event happening, you take the count of that specific event and divide it by the sum of all events.</li>
<li>Furthermore, the sum of all probabilities has to equal 1. If we pick a tweet at random, what is the probability of it being <code>+</code>? We define an event <code>A:</code> “A tweet is positive” and calculate its probability <span class="math display">
P(A) = P(+) = \frac{N_{+}}{N}=\frac{13}{20}=0.65
</span> And since probabilities add up to one: <span class="math display">
P(-) = 1- P(+)=0.35
</span> ## Probabiliy for a specific word’s sentiment Within that corpus, the word <code>happy</code> is sometimes labeled <code>+</code> and in other cases, <code>-</code>. This indicates that some negative tweets contain the word <code>happy</code>. Shown below is a graphical representation of this “overlap”. Let’s explore how we may represent this graphically using a <a href="https://en.wikipedia.org/wiki/Venn_diagram">venn diagram</a> and then derive a probability-based representation.  First, we need to estimate the probability of the event B: “tweets containing the word happy” <span class="math display">
P(B) = P(Happy)=\frac{N_{happy}}{N}=\frac{4}{20}=0.2
</span>  To compute the probability of 2 events happening like <code>happy</code> <strong>and</strong> <code>+</code> in the picture you would be looking at the intersection, or overlap of the two events, In this case, the red and the blue boxes overlap in three boxes, So the answer is: <span class="math display">
P(A \cap B) = P(A,B) = \frac{2}{20}
</span> The Event “A is labeled <code>+</code>”, - The probability of events A shown as P(A) is calculated as the ratio between the count of positive tweets and the corpus divided by the total number of tweets in the corpus. ::: {.column-margin layout-ncol=“1”} <img src="slide_027.png" class="img-fluid" alt="counting the intersection"> specific tweets color coded per the Venn diagram ::: ::: callout-note</li>
</ul>
<div class="no-row-height column-margin column-container"><img src="slide_021.png" class="img-fluid" alt="Tweets with “Happy”"><img src="slide_026.png" class="img-fluid" alt="Venn diagram for defining probabilities from events"></div></section>
<section id="definition-of-conditional-probability" class="level1 page-columns page-full">
<h1>Definition of conditional probability</h1>
<div class="page-columns page-full"><p><strong>Conditional probability</strong> is the <em>probability of an outcome <code>B</code> when we already know for certain that an event <code>A</code> has already happened</em>. Notation: <span class="math display">
P(B|A)
</span> ::: - and there more + than - more specifically our prior knowledge is that : <span class="math display">
    \frac{P(+)}{P(−)}=\frac{13}{7}
</span> - the likelihood of a tweet with happy being + is - the challenge arises from some words being in both + and - tweets Conditional probabilities help us reduce the sample search space by restricting it to a specific event which is a given. We should understand the difference between <span class="math inline">P(A|B)</span> and <span class="math inline">P(B|A)</span> ## what is <span class="math inline">P(+|happy)</span> - We start with the Venn diagram for the <span class="math inline">P(A|B)</span>.  - Where we restricted the diagram to just A the subset of happy tweets. - And we just want those tweets that are also <code>+</code> i.e.&nbsp;(B). - all we need is to plug in the counts from our count chart.  - which we now estimate <span class="math display">
  P(A|B) = P(Positive|happy) = \frac{3}{4} = 0.75
</span> ## what is <span class="math inline">P(happy|+)</span> - We start with the Venn diagram for the <span class="math inline">P(B|A)</span> - where we have restricted the diagram to just B the subset of <code>+</code> tweets.  - and we just want from those the tweets that are also <code>happy</code> i.e.&nbsp;(A). - and the counts for <span class="math inline">P(B|A)</span>  - which we now estimate <span class="math display">
  P(B|A) = P(happy|Positive) = \frac{3}{13} = 0.231
</span></p><div class="no-row-height column-margin column-container"><img src="slide_028.png" class="img-fluid" alt="Venn diagram for $P(A|B)$"><img src="slide_029.png" class="img-fluid" alt="Counts for $P(A|B)$"><img src="slide_030.png" class="img-fluid" alt="Venn diagram for the $P(B|A)$"><img src="slide_031.png" class="img-fluid" alt="Counts for $P(B|A)$"></div></div>
</section>
<section id="bayes-rule" class="level1 page-columns page-full">
<h1>Bayes’ rule</h1>
<div class="page-columns page-full"><p> From this, we can now write: <span class="math display">
P(+|happy) = \frac{P(+ \cap happy) }{P(happy)}
</span> and <span class="math display">
P(happy|+) = \frac{P(happy \cap +) }{P(+)}
</span> we can combine these since the intersections are the same and we get <span class="math display">
P(+|happy) = \frac{P(+ \cap happy) }{P(happy)} =  \frac{P(happy|+) \times P(+) }{P(happy)}
</span> which generalizes to: <span class="math display">
P(X|Y) = \frac{P(Y|X) \times P(X) }{P(Y)}
</span> which we call Bayes rule ::: callout-note ## Bayes Rule <strong>Bayes Rule</strong> is the rule for inverting conditional probabilities. ::: However, we gain a deeper insight by considering that Bayes’s rule is more than just a tool for inverting conditional probabilities but the basis of a casual framework for updating our beliefs as we uncover new evidence. <span class="math display">
p(H|e)=\frac{P(e|H) \times P(H)}{P(e|H)+P(e|\bar H)}  = \frac{P(e|H) \times P(H)}{P(e)}
</span> to reflect the notion of updating using new data. where we call: - <span class="math inline">p(H|e)</span> the posterior - <span class="math inline">P(H)</span> the prior - <span class="math inline">P(e|H)</span> the likelihood (of evidence given the Hypothesis is true). - <span class="math inline">P(e)</span> the marginal ## Naïve Bayes Introduction Here is a sample corpus ::: {#table-tweets } |<span style="color:blue">+</span> tweets| <span style="color:red">-</span> tweets | |—————|——————-| |<span style="color:blue">I am happy because I am learning NLP</span> |<span style="color:red">I am sad, I am not learning NLP</span> | |<span style="color:blue">I am happy</span> |<span style="color:red">I am sad</span> | And these are the class frequencies and probabilities Table of tweets :::</p><div class="no-row-height column-margin column-container"><img src="slide_026.png" class="img-fluid" alt="Venn diagram for defining probabilities from events"></div></div>
<div id="93f70904" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> string </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>raw_tweets<span class="op">=</span>[</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"I am happy because I am learning NLP"</span>,</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"I am sad, I am not learning NLP"</span>,</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"I am happy, not sad"</span>,</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"I am sad, not happy"</span>,</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> clean(tweet:<span class="bu">str</span>):</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span>  tweet.translate(<span class="bu">str</span>.maketrans(<span class="st">''</span>, <span class="st">''</span>, string.punctuation)).lower()</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>tweets <span class="op">=</span> [clean(tweet) <span class="cf">for</span> tweet <span class="kw">in</span> raw_tweets]</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>labels<span class="op">=</span>[<span class="st">'+'</span>,<span class="st">'-'</span>,<span class="st">'+'</span>,<span class="st">'-'</span>]</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame({<span class="st">'tweets'</span>: tweets, <span class="st">'labels'</span>: labels})</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">tweets</th>
<th data-quarto-table-cell-role="th">labels</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>i am happy because i am learning nlp</td>
<td>+</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>i am sad i am not learning nlp</td>
<td>-</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>i am happy not sad</td>
<td>+</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>i am sad not happy</td>
<td>-</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="5c3fcfad" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> Counter</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>p_freq,n_freq <span class="op">=</span> Counter(), Counter()</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co">#print( df[df.labels == '+']['tweets'].to_list())</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>[p_freq.update(tweet.split()) <span class="cf">for</span> tweet <span class="kw">in</span> df[df.labels <span class="op">==</span> <span class="st">'+'</span>][<span class="st">'tweets'</span>].to_list()]</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>[n_freq.update(tweet.split()) <span class="cf">for</span> tweet <span class="kw">in</span> df[df.labels <span class="op">==</span> <span class="st">'-'</span>][<span class="st">'tweets'</span>].to_list()]</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(p_freq)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(n_freq)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>vocab <span class="op">=</span> <span class="bu">list</span>(<span class="bu">set</span>(p_freq.keys()).union(<span class="bu">set</span>(n_freq.keys())))</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>pos_freq <span class="op">=</span> [p_freq[word] <span class="cf">for</span> word <span class="kw">in</span> vocab ]</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>neg_freq <span class="op">=</span> [n_freq[word] <span class="cf">for</span> word <span class="kw">in</span> vocab ]</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>vocab_df<span class="op">=</span>pd.DataFrame({<span class="st">'vocab'</span>:vocab,<span class="st">'pos_freq'</span>:pos_freq,<span class="st">'neg_freq'</span>:neg_freq})</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>vocab_df[<span class="st">'p_pos'</span>]<span class="op">=</span>vocab_df.pos_freq<span class="op">/</span>vocab_df.pos_freq.<span class="bu">sum</span>()</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>vocab_df[<span class="st">'p_neg'</span>]<span class="op">=</span>vocab_df.neg_freq<span class="op">/</span>vocab_df.neg_freq.<span class="bu">sum</span>()</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>vocab_df[<span class="st">'p_pos_sm'</span>]<span class="op">=</span>(vocab_df.pos_freq<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span>(vocab_df.pos_freq.<span class="bu">sum</span>()<span class="op">+</span>vocab_df.shape[<span class="dv">1</span>])</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>vocab_df[<span class="st">'p_neg_sm'</span>]<span class="op">=</span>(vocab_df.neg_freq<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span>(vocab_df.neg_freq.<span class="bu">sum</span>()<span class="op">+</span>vocab_df.shape[<span class="dv">1</span>])</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>vocab_df[<span class="st">'ratio'</span>]<span class="op">=</span> vocab_df.p_pos_sm<span class="op">/</span>vocab_df.p_neg_sm</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>vocab_df[<span class="st">'lambda'</span>]<span class="op">=</span> np.log(vocab_df.p_pos_sm<span class="op">/</span>vocab_df.p_neg_sm)</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>pd.set_option(<span class="st">'display.float_format'</span>, <span class="st">'</span><span class="sc">{:.2f}</span><span class="st">'</span>.<span class="bu">format</span>)</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>vocab_df</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(vocab_df.shape)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="2">
<pre><code>[None, None]</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="2">
<pre><code>[None, None]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Counter({'i': 3, 'am': 3, 'happy': 2, 'because': 1, 'learning': 1, 'nlp': 1, 'not': 1, 'sad': 1})
Counter({'i': 3, 'am': 3, 'sad': 2, 'not': 2, 'learning': 1, 'nlp': 1, 'happy': 1})
(8, 9)</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="2">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">vocab</th>
<th data-quarto-table-cell-role="th">pos_freq</th>
<th data-quarto-table-cell-role="th">neg_freq</th>
<th data-quarto-table-cell-role="th">p_pos</th>
<th data-quarto-table-cell-role="th">p_neg</th>
<th data-quarto-table-cell-role="th">p_pos_sm</th>
<th data-quarto-table-cell-role="th">p_neg_sm</th>
<th data-quarto-table-cell-role="th">ratio</th>
<th data-quarto-table-cell-role="th">lambda</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>happy</td>
<td>2</td>
<td>1</td>
<td>0.15</td>
<td>0.08</td>
<td>0.17</td>
<td>0.11</td>
<td>1.58</td>
<td>0.46</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>am</td>
<td>3</td>
<td>3</td>
<td>0.23</td>
<td>0.23</td>
<td>0.22</td>
<td>0.21</td>
<td>1.06</td>
<td>0.05</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>i</td>
<td>3</td>
<td>3</td>
<td>0.23</td>
<td>0.23</td>
<td>0.22</td>
<td>0.21</td>
<td>1.06</td>
<td>0.05</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>not</td>
<td>1</td>
<td>2</td>
<td>0.08</td>
<td>0.15</td>
<td>0.11</td>
<td>0.16</td>
<td>0.70</td>
<td>-0.35</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>because</td>
<td>1</td>
<td>0</td>
<td>0.08</td>
<td>0.00</td>
<td>0.11</td>
<td>0.05</td>
<td>2.11</td>
<td>0.75</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>sad</td>
<td>1</td>
<td>2</td>
<td>0.08</td>
<td>0.15</td>
<td>0.11</td>
<td>0.16</td>
<td>0.70</td>
<td>-0.35</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>nlp</td>
<td>1</td>
<td>1</td>
<td>0.08</td>
<td>0.08</td>
<td>0.11</td>
<td>0.11</td>
<td>1.06</td>
<td>0.05</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>learning</td>
<td>1</td>
<td>1</td>
<td>0.08</td>
<td>0.08</td>
<td>0.11</td>
<td>0.11</td>
<td>1.06</td>
<td>0.05</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> IPython.display <span class="im">import</span> Markdown</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tabulate <span class="im">import</span> tabulate</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>table <span class="op">=</span> [[<span class="st">"Sun"</span>,<span class="dv">696000</span>,<span class="dv">1989100000</span>],</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>         [<span class="st">"Earth"</span>,<span class="dv">6371</span>,<span class="fl">5973.6</span>],</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>         [<span class="st">"Moon"</span>,<span class="dv">1737</span>,<span class="fl">73.5</span>],</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>         [<span class="st">"Mars"</span>,<span class="dv">3390</span>,<span class="fl">641.85</span>]]</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>Markdown(tabulate(</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  table, </span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  headers<span class="op">=</span>[<span class="st">"Planet"</span>,<span class="st">"R (km)"</span>, <span class="st">"mass (x 10^29 kg)"</span>]</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="tbl-planet-measures" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-execution_count="3">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-planet-measures-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: Planets
</figcaption>
<div aria-describedby="tbl-planet-measures-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output cell-output-display cell-output-markdown" data-execution_count="3">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Planet</th>
<th style="text-align: right;">R (km)</th>
<th style="text-align: right;">mass (x 10^29 kg)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Sun</td>
<td style="text-align: right;">696000</td>
<td style="text-align: right;">1.9891e+09</td>
</tr>
<tr class="even">
<td style="text-align: left;">Earth</td>
<td style="text-align: right;">6371</td>
<td style="text-align: right;">5973.6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Moon</td>
<td style="text-align: right;">1737</td>
<td style="text-align: right;">73.5</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mars</td>
<td style="text-align: right;">3390</td>
<td style="text-align: right;">641.85</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<div id="tbl-vocab" class="quarto-layout-panel anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-vocab-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;2: Frequency Table {#tbl-first} | word | + | - | |———-|:—-:|:—-:| | I | 0.24 | 0.25 | | am | 0.24 | 0.25 | | happy | 0.15 | 0.08 | | because | 0.08 | 0.00 | | learning | 0.08 | 0.08 | | NLP | 0.08 | 0.08 | | sad | 0.08 | 0.17 | | not | 0.08 | 0.17 | : <span class="math inline">P(w_i|class)</span> table {#tbl-second} Probabilities
</figcaption>
<div aria-describedby="tbl-vocab-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;">word</th>
<th style="text-align: center;">+</th>
<th style="text-align: center;">-</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">I</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">3</td>
</tr>
<tr class="even">
<td style="text-align: left;">am</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">happy</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">because</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">learning</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">NLP</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sad</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">not</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Nclass</td>
<td style="text-align: center;">13</td>
<td style="text-align: center;">12</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</figure>
</div>
<div class="page-columns page-full"><p>Let’s motivate the Naïve Bayes inference condition rule for binary classification: To build a classifier, we will first start by creating conditional probabilities given the table;  - We want to find if given our prior knowledge of <span class="math inline">P(+)</span> and <span class="math inline">P(-)</span> if a new tweet has + or - sentiment. - To do that we will estimate <span class="math inline">p(+|T)</span> and <span class="math inline">p(-|T)</span> and then decide based on which is greater than 0.5.  We can use the Bayes rule: <span class="math display">
p(+|T) = \frac{ p(T|+) \times p(+) }{ p(T) }
</span> and <span class="math display">
p(-|T) = \frac{ p(T|-) \times p(-) }{ p(T) }
</span> where: - <span class="math inline">p(+|T)</span> is the <strong>posterior probability</strong> of a label <code>+</code> given tweet <code>T</code> - <span class="math inline">p(+)</span> is our <strong>prior</strong> knowledge - <span class="math inline">p(T|+)</span> is the <strong>likelihood</strong> of tweet T being <code>+</code>. - <span class="math inline">{p(T)}</span> The term <span class="math inline">p(T)</span> is in both terms and can be eliminated. However, it will cancel out when we use the ratio for the inference. This lets us compute the following table of probabilities; word am learning NLP Pos 0.24 0.08 0.08 Neg 0.25 0.08 0.08 .17 Naïve Bayes is the simplest probabilistic graphical model which comes with an independence assumption for the features. <span class="math display">
p(T|+) = \prod^m_{i=1}P(w_i|+) \implies p(+|T)=\frac{P(+)}{P(T)} \prod^m_{i=1}P(w_i|+)
</span> and <span class="math display">
p(T|−) = \prod^m_{i=1}P(w_i|−) \implies p(−|T) =  \frac{P(−)}{P(T)} \prod^m_{i=1} P(w_i|−)
</span> Once you have the probabilities, you can compute the likelihood score as follows: <strong>Tweet</strong>: <span style="color: blue;">I am happy today: I am learning</span>. - Since there is no entry for today in our conditional probabilities table, this implies that this word is not in your vocabulary. So we’ll ignore its contribution to the overall score. - All the neutral words in the tweet such as I and am cancel out in the expression, as shown in the figure below.</p><div class="no-row-height column-margin column-container"><img src="slide_032.png" class="img-fluid" alt="Naïve Bayes"><img src="slide_033.png" class="img-fluid" alt="Table of probabilities"></div></div>
<p><span class="math display">
   \prod^m_{i=1} \frac{P(w_i|+)}{P(w_i|-)}= \frac {0.14}{0.10} =1.4 &gt; 1
</span> - A score greater than 1 indicates that the class is positive, otherwise, it is negative.</p>
<p><span class="math display">
P(+|T) &gt; P(−|T)
</span> then we infer that the T has + sentiment. dividing by the right term we get the inference rule: <span class="math display">
\frac{P(+|T)}{P(−|T)} &gt; 1
</span> which expands to : <span class="math display">
  \frac {P(+|T)}{P(−|T)} = \frac {P(+)}{P(-)}\prod^m_{i=1} \frac {P(w_i|+)}{P(w_i|−)} &gt; 1
</span> This is the inference rule for naïve Bayes. Note: Naïve Bayes is a model which assumes all features are independent, so the basic component here is: <span class="math display">
\frac{P(w_i|+)}{P(w_i|-)} &gt; 1
</span> the ratio of the probability that a word appears in a positive tweet and that it appears in a negative tweet</p>
</section>
<section id="laplace-smoothing" class="level1 page-columns page-full">
<h1>Laplace smoothing</h1>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Smoothing
</div>
</div>
<div class="callout-body-container callout-body">
<p>A probability distribution can take zero values at certain points i.e.&nbsp;for certain inputs. <code>Smoothing</code> is a family of techniques for improving our estimate of conditional class probabilities to estimate probabilities for missing words. The name smoothing comes from the fact that these techniques tend to make distributions more uniform, by adjusting low probabilities such as zero probabilities upward, and high probabilities downward. Not only do smoothing methods generally prevent zero probabilities, but they also attempt to improve the accuracy of the model as a whole. Whenever a probability is estimated from a few counts, smoothing has the potential to improve estimation.</p>
</div>
</div>
<div class="page-columns page-full"><p> The course introduces smoothing here since sparsity breaks the naive Bayes model. But smoothing and filtering are big topics in NLP and Data Science. I have added some extra info drawn from <span class="citation" data-cites="jurafsky2000speech">(<a href="#ref-jurafsky2000speech" role="doc-biblioref">Jurafsky and Martin 2000</a>)</span> <code>Laplace smoothing</code> also called <code>add one smoothing</code> replaces a distribution with zero probabilities (due to sparse data) with a distribution that steals some mass and spreads it over the points which were zero. It solves the data sparsity issue but <code>Laplace smoothing</code> will skew/bias the probabilities (it affects rare and common probabilities differently) giving you behavior that is hard to explain, as it assigns too much mass to unknown words. When we compute the conditional probability <span class="math inline">P(w|class)</span> using: <span class="math display">
P(w_i|class) = \frac{freq(w_i,class)}{N_{class}} \qquad class \in \{ +, -\}
</span> If a word does not appear in the training corpus or is missing from one of the classes then its frequency is 0 so it gets a probability of 0. Since we are taking products of probabilities, and soon we will take logs of probabilities and zeros present us with a numerical problem that we can address using <code>smoothing</code> as follows: <span class="math display">
P(w_i|class) = \frac{freq(w_i,class) + 1}{N_{class} + |V|}
</span> where: - <span class="math inline">N_{class}</span> is the frequency of all words in a class. - <span class="math inline">V</span> is unique words in the vocabulary Note: that we added a 1 in the numerator and since there are <span class="math inline">|V|</span> words to normalize we add <span class="math inline">|V|</span> in the denominator so that all the probabilities sum up to 1.</p><div class="no-row-height column-margin column-container"><img src="slide_076.png" class="img-fluid" alt="Laplace smoothing"></div></div>
<div id="tbl-vocab" class="quarto-layout-panel anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-vocab-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;3: <span class="math inline">P(w_i|class)</span> no smoothing {#tbl-unsmoothed} | word | + | - | |———-|:—-:|:—-:| | I | 0.20 | 0.20 | | am | 0.20 | 0.20 | | happy | 0.14 | 0.10 | | because | 0.10 | <span style="color:blue">0.05</span> | | learning | 0.10 | 0.10 | | NLP | 0.10 | 0.10 | | sad | 0.10 | 0.15 | | not | 0.10 | 0.15 | : <span class="math inline">P(w_i|class)</span> with smoothing {#tbl-smoothing} Probabilities
</figcaption>
<div aria-describedby="tbl-vocab-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;">word</th>
<th style="text-align: center;">+</th>
<th style="text-align: center;">-</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">I</td>
<td style="text-align: center;">0.24</td>
<td style="text-align: center;">0.25</td>
</tr>
<tr class="even">
<td style="text-align: left;">am</td>
<td style="text-align: center;">0.24</td>
<td style="text-align: center;">0.25</td>
</tr>
<tr class="odd">
<td style="text-align: left;">happy</td>
<td style="text-align: center;">0.15</td>
<td style="text-align: center;">0.08</td>
</tr>
<tr class="even">
<td style="text-align: left;">because</td>
<td style="text-align: center;">0.08</td>
<td style="text-align: center;"><span style="color:red">0.00</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">learning</td>
<td style="text-align: center;">0.08</td>
<td style="text-align: center;">0.08</td>
</tr>
<tr class="even">
<td style="text-align: left;">NLP</td>
<td style="text-align: center;">0.08</td>
<td style="text-align: center;">0.08</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sad</td>
<td style="text-align: center;">0.08</td>
<td style="text-align: center;">0.17</td>
</tr>
<tr class="even">
<td style="text-align: left;">not</td>
<td style="text-align: center;">0.08</td>
<td style="text-align: center;">0.17</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</figure>
</div>
<section id="additive-smoothing" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="additive-smoothing">Additive smoothing:</h2>
<div class="page-columns page-full"><p><span class="math display">
p_{addative}(w_i|class)=\frac{ freq(w,class)+\delta}{ N_{class} + \delta \times V}
</span> ## More alternatives to Laplacian smoothing - <code>Kneser-Ney smoothing</code> <span class="citation" data-cites="NEY19941">(<a href="#ref-NEY19941" role="doc-biblioref"><strong>NEY19941?</strong></a>)</span> which corrects better for smaller data sets.  - <code>Good-Turing smoothing</code> <span class="citation" data-cites="good1953population">(<a href="#ref-good1953population" role="doc-biblioref">Good 1953</a>)</span> which uses order statistics to give even better estimates.  with a survey of the subject here: <a href="https://dash.harvard.edu/bitstream/handle/1/25104739/tr-10-98.pdf;jsessionid=CC44A707FD117F63DB2870EA0CE00370?sequence=1"><span class="citation" data-cites="chen1996empirical">Chen and Goodman (<span>1996</span>)</span></a></p><div class="no-row-height column-margin column-container"><img src="slide_034.png" class="img-fluid" alt="Kneser-Ney smoothing"><img src="slide_035.png" class="img-fluid" alt="Good Turing smoothing"></div></div>
</section>
</section>
<section id="ratio-of-probabilities" class="level1">
<h1>Ratio of probabilities</h1>
<p><span class="math display">
ratio(w_i)=\frac{P(w_i|+)}{P(w_i|-)} \approx \frac{freq(w_i|+)+1}{freq(w_i|-)+1}
</span></p>
</section>
<section id="log-likelihood" class="level1">
<h1>Log Likelihood</h1>
<p>recall that <span class="math display">
  \frac {P(+|T)}{P(−|T)} = \frac {P(+)}{P(-)}\prod^m_{i=1} \frac {P(w_i|+)}{P(w_i|−)} &gt; 1
</span> taking logs we get <span class="math display">
  \log \frac{P(+|T)}{P(−|T)} = \log \frac {P(+)}{P(-)} + \sum^m_{i=1} \lambda(w_i) &gt; 0
</span> where <span class="math display">
\lambda(w_i) = log \frac {P(w_i|+)}{P(w_i|−)}
</span> To compute the likelihood, we need to get the ratios and use them to compute a score that Will allow us to decide if a tweet is positive or negative. The higher the ratio, the more positive the word. - Long Products of small probabilities create a risk of numeric underflow. - logs let us mitigate this risk. <span class="math display">
\lambda(w) = \log \frac{p(w|+)}{p(w|-)}
</span> <span class="math display">
\log prior = \log \frac{p(+)}{p(-)}
</span> Where <span class="math inline">D_{+}</span> and <span class="math inline">D_{-}</span> correspond to the number Of negative documents respectively.</p>
</section>
<section id="training-naïve-bayes" class="level1 page-columns page-full">
<h1>Training Naïve Bayes</h1>
<div class="page-columns page-full"><p>To train a naïve Bayes classifier, we should perform the following steps: 1. Get or annotate a dataset with positive and negative tweets 2. preprocess the tweets.  - Tokenize sentences - Remove punctuation, URLs and names - Remove stop words - Stem words<br>
3. Compute the vocaulary: freq(word, class)  4. Use Laplacian smoothing to estimate word class probabilites <span class="math inline">P(w|+)</span> and <span class="math inline">P(w|-)</span>.  5. Compute <span class="math inline">\lambda(w) = \log \frac{p(w|+)}{p(w|-)}</span>  6. Compute <span class="math inline">logprior = \log \frac{p(w|+)}{p(w|-)}</span> Where <span class="math inline">D_{+}</span> and <span class="math inline">D_{-}</span> correspond to the number Of negative documents respectively.</p><div class="no-row-height column-margin column-container"><img src="slide_045.jpg" class="img-fluid" alt="Training"><img src="slide_046.jpg" class="img-fluid" alt="Training"><img src="slide_047.jpg" class="img-fluid" alt="Training"><img src="slide_048.jpg" class="img-fluid" alt="Training"></div></div>
</section>
<section id="testing-naïve-bayes" class="level1 page-columns page-full">
<h1>Testing Naïve Bayes</h1>
<div class="page-columns page-full"><p> Let’s work on applying the Naïve Bayes classifier on validation examples to compute the model’s accuracy. The steps involved in testing a Naïve Bayes model for sentiment analysis are as follows: 1. Use the validation set to test the model on tweets it has not seen. Which is comprised of a set of raw tweets <span class="math inline">X_{val}</span>, and their corresponding sentiments, <span class="math inline">Y_{val}</span>. 1. We use the conditional <span class="math inline">p(word|state)</span> and use them to predict the sentiments of new unseen tweets, 2. We apply <strong>Pre-processing</strong>: as before in training. 3. Lookup the <span class="math inline">\lambda</span> score for each unique word: Using the <span class="math inline">\lambda</span> table (i.e., the log-likelihood table). - Words that have entries in the table, are summed over all the corresponding <span class="math inline">\lambda</span> terms. - <strong>Unknown words are skipped</strong> as words that lack a log-likelihood in the table are considered neutral. 4. <strong>Obtain the overall score</strong> by summing up the scores of all the individual words, along with with our estimation of the log prior (important for an unbalanced dataset), we get the overall sentiment score of the new tweet. 5. <strong>Check against the threshold</strong> we check if the sentiment score &gt;0 . Let’s consider an example tweet, <code>"I passed the NLP interview"</code>, and use our trained model to predict if this is a positive or negative tweet: - Look up each word from the vector in your log-likelihood table. Words such as “I”, “pass”, “the”, and “NLP”, have entries in the table, while the word interview does not (which implies that it needs to be ignored). Now, add the log before accounting for the imbalance of classes in the dataset. Thus, the overall score sums up to 0.48, as shown in the figure below. - Recall that if the overall score of the tweet is larger than 0, then this tweet has a positive sentiment, so the overall prediction is that this tweet has a positive sentiment. Even in real life, passing the NLP interview is a very positive thing.</p><div class="no-row-height column-margin column-container"><img src="slide_050.jpg" class="img-fluid" alt="Inference"></div></div>
</section>
<section id="naïve-bayes-applications" class="level1">
<h1>Naïve Bayes Applications</h1>
<p>There are many applications of naïve Bayes including: - Author identification - Spam filtering - Information retrieval - Word disambiguation</p>
<ul>
<li>This method is usually used as a simple baseline.</li>
<li>It is also really fast.</li>
</ul>
</section>
<section id="naïve-bayes-assumptions" class="level1">
<h1>Naïve Bayes Assumptions</h1>
<p>Naïve Bayes makes the <strong>independence</strong> assumption and is affected by the word frequencies in the corpus. For example, if you had the following <code>"It is sunny and hot in the Sahara desert."</code> `“It’s always cold and snowy in …”<code>In the first image, you can see the word sunny and hot tend to depend on each other and are correlated to a certain extent with the"desert", Naïve Independence throughout,  Furthermore, if you were to fill in the sentence on the right. this naïve model will assign equal weight to the words : - spring.  - summer,  - fall, - winter, Relative frequencies in the corpus On Twitter, there are usually more positive tweets than negative ones However, some clean datasets are artificially balanced to have the same amount of positive and negative tweets. Just keep in mind, that in me real world. the data could be much noisier. ## Sources of Errors in Naïve Bayes ### Error Analysis Bad sentiment classifications are due to: 1. preprocessing dropping punctuation that encodes emotion like a</code>sad smiley`. 1. Word order can contribute to meaning - breaking the independence assumption of our model 1. Pronouns removed as stop words - may encode emotion 1. Sarcasm can confound the model 1. Eupemisms are also a challange</p>
</section>
<section id="resources" class="level1">
<h1>resources:</h1>
<p>notes on the course by</p>



</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-chadha2020distilled" class="csl-entry" role="listitem">
Chadha, Aman. 2020. <span>“Distilled Notes for the Natural Language Processing Specialization on Coursera (Offered by Deeplearning.ai).”</span> <a href="https://www.aman.ai" class="uri">https://www.aman.ai</a>. <a href="https://www.aman.ai">www.aman.ai</a>.
</div>
<div id="ref-chen1996empirical" class="csl-entry" role="listitem">
Chen, Stanley F., and Joshua T. Goodman. 1996. <span>“An Empirical Study of Smoothing Techniques for Language Modeling.”</span> <a href="https://arxiv.org/abs/cmp-lg/9606011">https://arxiv.org/abs/cmp-lg/9606011</a>.
</div>
<div id="ref-good1953population" class="csl-entry" role="listitem">
Good, I. J. 1953. <span>“The Population Frequencies of Species and the Estimation of Population Parameters.”</span> <em>Biometrika</em> 40 (3-4): 237–64. <a href="https://doi.org/10.1093/biomet/40.3-4.237">https://doi.org/10.1093/biomet/40.3-4.237</a>.
</div>
<div id="ref-jurafsky2000speech" class="csl-entry" role="listitem">
Jurafsky, D., and J. H. Martin. 2000. <em>Speech and Language Processing: An Introduction to Natural Language Processing, Computational Linguistics, and Speech Recognition</em>. Prentice Hall Series in Artificial Intelligence. Prentice Hall. <a href="https://books.google.co.il/books?id=85BvQgAACAAJ">https://books.google.co.il/books?id=85BvQgAACAAJ</a>.
</div>
</div></section><section class="quarto-appendix-contents" id="quarto-reuse"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div class="quarto-appendix-contents"><div>CC SA BY-NC-ND</div></div></section><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{bochman2020,
  author = {Bochman, Oren},
  title = {Classification \&amp; {Vector} {Spaces} - {Probability} and
    {Bayes’} {Rule}},
  date = {2020-10-23},
  url = {https://orenbochman.github.io//notes/deeplearning.ai-nlp-c1/l2-naive-bayes/l2-native-bayes.html},
  langid = {en}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-bochman2020" class="csl-entry quarto-appendix-citeas" role="listitem">
Bochman, Oren. 2020. <span>“Classification &amp; Vector Spaces -
Probability and Bayes’ Rule.”</span> October 23, 2020. <a href="https://orenbochman.github.io//notes/deeplearning.ai-nlp-c1/l2-naive-bayes/l2-native-bayes.html">https://orenbochman.github.io//notes/deeplearning.ai-nlp-c1/l2-naive-bayes/l2-native-bayes.html</a>.
</div></div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("^(?:http:|https:)\/\/www\.quarto\.org\/custom");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
          // default icon
          link.classList.add("external");
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
      for (let i=0; i<annoteTargets.length; i++) {
        const annoteTarget = annoteTargets[i];
        const targetCell = annoteTarget.getAttribute("data-target-cell");
        const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
        const contentFn = () => {
          const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          if (content) {
            const tipContent = content.cloneNode(true);
            tipContent.classList.add("code-annotation-tip-content");
            return tipContent.outerHTML;
          }
        }
        const config = {
          allowHTML: true,
          content: contentFn,
          onShow: (instance) => {
            selectCodeLines(instance.reference);
            instance.reference.classList.add('code-annotation-active');
            window.tippy.hideAll();
          },
          onHide: (instance) => {
            unselectCodeLines();
            instance.reference.classList.remove('code-annotation-active');
          },
          maxWidth: 300,
          delay: [50, 0],
          duration: [200, 0],
          offset: [5, 10],
          arrow: true,
          appendTo: function(el) {
            return el.parentElement.parentElement.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto',
          placement: 'right',
          popperOptions: {
            modifiers: [
            {
              name: 'flip',
              options: {
                flipVariations: false, // true by default
                allowedAutoPlacements: ['right'],
                fallbackPlacements: ['right', 'top', 'top-start', 'top-end', 'bottom', 'bottom-start', 'bottom-end', 'left'],
              },
            },
            {
              name: 'preventOverflow',
              options: {
                mainAxis: false,
                altAxis: false
              }
            }
            ]        
          }      
        };
        window.tippy(annoteTarget, config); 
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://utteranc.es/client.js" repo="OrenBochman/blogComments" issue-term="pathname" theme="github-light" crossorigin="anonymous" async="">
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
 Copyright 2024, Oren Bochman
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="../../../about.html">
<p>About</p>
</a>
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="../../../license.html">
<p>License</p>
</a>
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="../../../trademark.html">
<p>Trademark</p>
</a>
  </li>  
</ul>
    </div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>
    <script type="text/javascript">
    (function(d) {
      d.querySelectorAll(".pseudocode-container").forEach(function(el) {
        let pseudocodeOptions = {
          indentSize: el.dataset.indentSize || "1.2em",
          commentDelimiter: el.dataset.commentDelimiter || "//",
          lineNumber: el.dataset.lineNumber === "true" ? true : false,
          lineNumberPunc: el.dataset.lineNumberPunc || ":",
          noEnd: el.dataset.noEnd === "true" ? true : false,
          titlePrefix: el.dataset.algTitle || "Algorithm"
        };
        pseudocode.renderElement(el.querySelector(".pseudocode"), pseudocodeOptions);
      });
    })(document);
    (function(d) {
      d.querySelectorAll(".pseudocode-container").forEach(function(el) {
        titleSpan = el.querySelector(".ps-root > .ps-algorithm > .ps-line > .ps-keyword")
        titlePrefix = el.dataset.algTitle;
        titleIndex = el.dataset.chapterLevel ? el.dataset.chapterLevel + "." + el.dataset.pseudocodeIndex : el.dataset.pseudocodeIndex;
        titleSpan.innerHTML = titlePrefix + " " + titleIndex + " ";
      });
    })(document);
    </script>
  




<script src="../../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>