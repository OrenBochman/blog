<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.550">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Oren Bochman">
<meta name="dcterms.date" content="2017-08-10">
<meta name="description" content="Notes on Deep leaning and ML from Neural Networks for Machine Learning by Geoffrey Hinton on Coursera">

<title>Oren Bochman’s Blog - Deep Neural Networks - Notes for Lesson 4</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<script src="../../../site_libs/cookie-consent/cookie-consent.js"></script>
<link href="../../../site_libs/cookie-consent/cookie-consent.css" rel="stylesheet">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script src="../../../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../../../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../../../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

<script type="text/javascript" charset="UTF-8">
document.addEventListener('DOMContentLoaded', function () {
cookieconsent.run({
  "notice_banner_type":"simple",
  "consent_type":"implied",
  "palette":"light",
  "language":"en",
  "page_load_consent_levels":["strictly-necessary","functionality","tracking","targeting"],
  "notice_banner_reject_button_hide":false,
  "preferences_center_close_button_hide":false,
  "website_name":""
  ,
"language":"en"
  });
});
</script> 
  
<style>html{ scroll-behavior: smooth; }</style>
<style>

      .quarto-title-block .quarto-title-banner {
        background-image: url(banner_deep.jpg);
background-size: cover;
      }
</style>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css">

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<meta name="twitter:title" content="Oren Bochman’s Blog - Deep Neural Networks - Notes for Lesson 4">
<meta name="twitter:description" content="Notes on Deep leaning and ML from Neural Networks for Machine Learning by Geoffrey Hinton on Coursera">
<meta name="twitter:image" content="https://orenbochman.github.io/blog/notes/dnn/dnn-04/thumbnail_blog.png">
<meta name="twitter:creator" content="@orenbochman">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="floating nav-fixed slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../../images/logo.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">Oren Bochman’s Blog</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-bi-book" role="button" data-bs-toggle="dropdown" aria-expanded="false">
      <i class="bi bi-book" role="img">
</i> 
 <span class="menu-text"></span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-bi-book">    
        <li>
    <a class="dropdown-item" href="../../../dnn.html">
 <span class="dropdown-text">Neural Networks for Machine Learning</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../model-thinking.html">
 <span class="dropdown-text">Model Thinking</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../xai.html">
 <span class="dropdown-text">XAI</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../rl.html">
 <span class="dropdown-text">rl</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../rhetoric.html">
 <span class="dropdown-text">rhetoric</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../tfp.html">
 <span class="dropdown-text">TFP</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../ab-testing.html">
 <span class="dropdown-text">AB testing</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../cognitiveai.html">
 <span class="dropdown-text">cognitive AI</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/orenbochman"> <i class="bi bi-twitter" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-bi-github" role="button" data-bs-toggle="dropdown" aria-expanded="false">
      <i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-bi-github">    
        <li>
    <a class="dropdown-item" href="https://github.com/OrenBochman/blog">
 <span class="dropdown-text">Source Code</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://github.com/OrenBochman/blog/issues">
 <span class="dropdown-text">Report a Bug</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item compact">
    <a class="nav-link" href="../../../index.xml"> <i class="bi bi-rss" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../archive.html"> <i class="bi bi-archive" role="img">
</i> 
<span class="menu-text">Archive</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default toc-left page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Deep Neural Networks - Notes for Lesson 4</h1>
            <p class="subtitle lead">For a course by Geoffrey Hinton on Coursera</p>
                  <div>
        <div class="description">
          Notes on Deep leaning and ML from Neural Networks for Machine Learning by Geoffrey Hinton on Coursera
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">deep learning</div>
                <div class="quarto-category">neural networks</div>
                <div class="quarto-category">notes</div>
                <div class="quarto-category">coursera</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Oren Bochman </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">August 10, 2017</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#lecture-4a-learning-to-predict-the-next-word" id="toc-lecture-4a-learning-to-predict-the-next-word" class="nav-link active" data-scroll-target="#lecture-4a-learning-to-predict-the-next-word">Lecture 4a: Learning to predict the next word</a>
  <ul class="collapse">
  <li><a href="#a-simple-example-of-relational-information" id="toc-a-simple-example-of-relational-information" class="nav-link" data-scroll-target="#a-simple-example-of-relational-information">A simple example of relational information</a></li>
  <li><a href="#another-way-to-express-the-same-information" id="toc-another-way-to-express-the-same-information" class="nav-link" data-scroll-target="#another-way-to-express-the-same-information">Another way to express the same information</a></li>
  <li><a href="#a-relational-learning-task" id="toc-a-relational-learning-task" class="nav-link" data-scroll-target="#a-relational-learning-task">A relational learning task</a></li>
  <li><a href="#the-structure-of-the-neural-net" id="toc-the-structure-of-the-neural-net" class="nav-link" data-scroll-target="#the-structure-of-the-neural-net">The structure of the neural net</a></li>
  <li><a href="#what-the-network-learns" id="toc-what-the-network-learns" class="nav-link" data-scroll-target="#what-the-network-learns">What the network learns ?</a></li>
  <li><a href="#another-way-to-see-that-it-works" id="toc-another-way-to-see-that-it-works" class="nav-link" data-scroll-target="#another-way-to-see-that-it-works">Another way to see that it works</a></li>
  <li><a href="#a-large-scale-example" id="toc-a-large-scale-example" class="nav-link" data-scroll-target="#a-large-scale-example">A large-scale example</a></li>
  <li><a href="#a-relational-learning-task-1" id="toc-a-relational-learning-task-1" class="nav-link" data-scroll-target="#a-relational-learning-task-1">A relational learning task</a></li>
  <li><a href="#the-structure-of-the-neural-net-1" id="toc-the-structure-of-the-neural-net-1" class="nav-link" data-scroll-target="#the-structure-of-the-neural-net-1">The structure of the neural net</a></li>
  </ul></li>
  <li><a href="#lecture-4b-a-brief-diversion-into-cognitive-science" id="toc-lecture-4b-a-brief-diversion-into-cognitive-science" class="nav-link" data-scroll-target="#lecture-4b-a-brief-diversion-into-cognitive-science">Lecture 4b: A brief diversion into cognitive science</a></li>
  <li><a href="#lecture-4c-another-diversion-the-softmax-output-function" id="toc-lecture-4c-another-diversion-the-softmax-output-function" class="nav-link" data-scroll-target="#lecture-4c-another-diversion-the-softmax-output-function">Lecture 4c: Another diversion: The Softmax output function</a>
  <ul class="collapse">
  <li><a href="#problems-with-squared-error" id="toc-problems-with-squared-error" class="nav-link" data-scroll-target="#problems-with-squared-error">Problems with squared error</a></li>
  <li><a href="#softmax" id="toc-softmax" class="nav-link" data-scroll-target="#softmax">Softmax</a></li>
  <li><a href="#cross-entropy-the-right-cost-function-to-use-with-softmax" id="toc-cross-entropy-the-right-cost-function-to-use-with-softmax" class="nav-link" data-scroll-target="#cross-entropy-the-right-cost-function-to-use-with-softmax">Cross-entropy: the right cost function to use with SoftMax</a></li>
  </ul></li>
  <li><a href="#lecture-4d-neuro-probabilistic-language-models" id="toc-lecture-4d-neuro-probabilistic-language-models" class="nav-link" data-scroll-target="#lecture-4d-neuro-probabilistic-language-models">Lecture 4d: Neuro-probabilistic language models</a>
  <ul class="collapse">
  <li><a href="#a-basic-problem-in-speech-recognition" id="toc-a-basic-problem-in-speech-recognition" class="nav-link" data-scroll-target="#a-basic-problem-in-speech-recognition">A basic problem in speech recognition</a></li>
  <li><a href="#the-standard-trigram-method" id="toc-the-standard-trigram-method" class="nav-link" data-scroll-target="#the-standard-trigram-method">The standard “trigram” method</a></li>
  <li><a href="#information-that-the-trigram-model-fails-to-use" id="toc-information-that-the-trigram-model-fails-to-use" class="nav-link" data-scroll-target="#information-that-the-trigram-model-fails-to-use">Information that the trigram model fails to use</a></li>
  </ul></li>
  <li><a href="#lecture-4e-ways-to-deal-with-the-large-number-of-possible-outputs" id="toc-lecture-4e-ways-to-deal-with-the-large-number-of-possible-outputs" class="nav-link" data-scroll-target="#lecture-4e-ways-to-deal-with-the-large-number-of-possible-outputs">Lecture 4e: Ways to deal with the large number of possible outputs</a></li>
  <li><a href="#bengios-neural-net-for-predicting-the-next-word" id="toc-bengios-neural-net-for-predicting-the-next-word" class="nav-link" data-scroll-target="#bengios-neural-net-for-predicting-the-next-word">Bengio’s neural net for predicting the next word</a>
  <ul class="collapse">
  <li><a href="#a-serial-architecture" id="toc-a-serial-architecture" class="nav-link" data-scroll-target="#a-serial-architecture">A serial architecture</a></li>
  <li><a href="#learning-in-the-serial-architecture" id="toc-learning-in-the-serial-architecture" class="nav-link" data-scroll-target="#learning-in-the-serial-architecture">Learning in the serial architecture</a></li>
  <li><a href="#learning-to-predict-the-next-word-by-predicting-a-path-through-a-tree" id="toc-learning-to-predict-the-next-word-by-predicting-a-path-through-a-tree" class="nav-link" data-scroll-target="#learning-to-predict-the-next-word-by-predicting-a-path-through-a-tree">Learning to predict the next word by predicting a path through a tree</a></li>
  <li><a href="#a-picture-of-the-learning" id="toc-a-picture-of-the-learning" class="nav-link" data-scroll-target="#a-picture-of-the-learning">A picture of the learning</a></li>
  <li><a href="#a-convenient-decomposition" id="toc-a-convenient-decomposition" class="nav-link" data-scroll-target="#a-convenient-decomposition">A convenient decomposition</a></li>
  </ul></li>
  <li><a href="#a-simpler-way-to-learn-feature-vectors-for-words" id="toc-a-simpler-way-to-learn-feature-vectors-for-words" class="nav-link" data-scroll-target="#a-simpler-way-to-learn-feature-vectors-for-words">A simpler way to learn feature vectors for words</a>
  <ul class="collapse">
  <li><a href="#displaying-the-learned-feature-vectors-in-a-2-d-map" id="toc-displaying-the-learned-feature-vectors-in-a-2-d-map" class="nav-link" data-scroll-target="#displaying-the-learned-feature-vectors-in-a-2-d-map">Displaying the learned feature vectors in a 2-D map</a></li>
  <li><a href="#part-of-a-2-d-map-of-the-2500-most-common-words" id="toc-part-of-a-2-d-map-of-the-2500-most-common-words" class="nav-link" data-scroll-target="#part-of-a-2-d-map-of-the-2500-most-common-words">Part of a 2-D map of the 2500 most common words</a></li>
  </ul></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
    </div>
<!-- main -->
<main class="content quarto-banner-title-block page-columns page-full" id="quarto-document-content">






<div class="no-row-height column-margin column-container"><div class="">
<p><object data="lec4.pdf" type="application/pdf"><p>Unable to display PDF file. <a href="lec4.pdf">Download</a> instead.</p></object></p>
</div></div><p>We have the basic method for creating hidden layers (backprop), we’re going to see what can be achieved with them. We start to ask how the network learns to use its hidden units, with a toy application to family trees and a real application to language modeling.</p>
<section id="lecture-4a-learning-to-predict-the-next-word" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="lecture-4a-learning-to-predict-the-next-word">Lecture 4a: Learning to predict the next word</h2>

<div class="no-row-height column-margin column-container"><div class="">
<div class="quarto-video ratio ratio-16x9"><iframe data-external="1" src="https://www.youtube.com/embed/Rtk_juucCHc" title="Lecture 4 : Learning feature vectors for words" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div>
</div></div><section id="a-simple-example-of-relational-information" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="a-simple-example-of-relational-information">A simple example of relational information</h3>

<div class="no-row-height column-margin column-container"><div class="">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="relational_information_1.png" class="lightbox" data-glightbox="description: .lightbox-desc-1" data-gallery="quarto-lightbox-gallery-1" title="relational information"><img src="relational_information_1.png" class="img-fluid figure-img" alt="relational information"></a></p>
<figcaption>relational information</figcaption>
</figure>
</div>
</div></div></section>
<section id="another-way-to-express-the-same-information" class="level3">
<h3 class="anchored" data-anchor-id="another-way-to-express-the-same-information">Another way to express the same information</h3>
<ul>
<li>Make a set of propositions using the 12 relationships:
<ul>
<li>son, daughter, nephew, niece, father, mother, uncle, aunt</li>
<li>brother, sister, husband, wife</li>
</ul></li>
<li>(Colin has-father James)</li>
<li>(Colin has-mother Victoria)</li>
<li>(James has-wife Victoria) this follows from the two above</li>
<li>(Charlotte has-brother Colin)</li>
<li>(Victoria has-brother Arthur)</li>
<li>(Charlotte has-uncle Arthur) this follows from the above</li>
</ul>
</section>
<section id="a-relational-learning-task" class="level3">
<h3 class="anchored" data-anchor-id="a-relational-learning-task">A relational learning task</h3>
<ul>
<li>Given a large set of triples that come from some family trees, figure out the regularities.
<ul>
<li><mark>The <strong>obvious</strong> way to express the regularities is as symbolic rules (x has-mother y) &amp; (y has-husband z) =&gt; (x has-father z)</mark></li>
</ul></li>
<li>Finding the symbolic rules involves a difficult search through a very large discrete space of possibilities.</li>
<li>Can a neural network capture the same knowledge by searching through a <strong>continuous space of weights</strong>?</li>
</ul>
</section>
<section id="the-structure-of-the-neural-net" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="the-structure-of-the-neural-net">The structure of the neural net</h3>

<div class="no-row-height column-margin column-container"><div class="">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="relational_information.png" class="lightbox" data-glightbox="description: .lightbox-desc-2" data-gallery="quarto-lightbox-gallery-2" title="structure of the neural net"><img src="relational_information.png" class="img-fluid figure-img" alt="structure of the neural net"></a></p>
<figcaption>structure of the neural net</figcaption>
</figure>
</div>
</div><div class="">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="neuron_weights_vizulization.png" class="lightbox" data-glightbox="description: .lightbox-desc-3" data-gallery="quarto-lightbox-gallery-3" title="visulization of 6 neuron weights"><img src="neuron_weights_vizulization.png" class="img-fluid figure-img" alt="visulization of 6 neuron weights"></a></p>
<figcaption>visulization of 6 neuron weights</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="relational_information_2.png" class="lightbox" data-glightbox="description: .lightbox-desc-4" data-gallery="quarto-lightbox-gallery-4" title="the relational data"><img src="relational_information_2.png" class="img-fluid figure-img" alt="the relational data"></a></p>
<figcaption>the relational data</figcaption>
</figure>
</div>
</div></div>
</section>
<section id="what-the-network-learns" class="level3">
<h3 class="anchored" data-anchor-id="what-the-network-learns">What the network learns ?</h3>
<ul>
<li>The six hidden units in the bottleneck connected to the input representation of person 1 learn to represent features of people that are useful for predicting the answer.
<ul>
<li>Nationality, generation, branch of the family tree.</li>
</ul></li>
<li>These features are only useful if the other bottlenecks use similar representations and the central layer learns how features predict other features. For example:
<ul>
<li>Input person is of generation 3 and</li>
<li>relationship requires answer to be one generation up</li>
<li>implies</li>
<li>Output person is of generation 2</li>
</ul></li>
</ul>
</section>
<section id="another-way-to-see-that-it-works" class="level3">
<h3 class="anchored" data-anchor-id="another-way-to-see-that-it-works">Another way to see that it works</h3>
<ul>
<li>Train the network on all but 4 of the triples that can be made using the 12 relationships
<ul>
<li>It needs to sweep through the training set many times adjusting the weights slightly each time.</li>
</ul></li>
<li>Then test it on the 4 held-out cases.
<ul>
<li>It gets about 3/4 correct.</li>
<li>This is good for a 24-way choice.</li>
<li>On much bigger datasets we can train on a much smaller fraction of the data.</li>
</ul></li>
</ul>
</section>
<section id="a-large-scale-example" class="level3">
<h3 class="anchored" data-anchor-id="a-large-scale-example">A large-scale example</h3>
<ul>
<li>Suppose we have a database of millions of relational facts of the form (A R B).
<ul>
<li>We could train a net to discover feature vector representations of the terms that allow the third term to be predicted from the first two.</li>
<li>Then we could use the trained net to find very unlikely triples. These are good candidates for errors in the database.</li>
</ul></li>
<li>Instead of predicting the third term, we could use all three terms as input and predict the probability that the fact is correct.
<ul>
<li>To train such a net we need a good source of false facts.</li>
</ul></li>
</ul>
</section>
<section id="a-relational-learning-task-1" class="level3">
<h3 class="anchored" data-anchor-id="a-relational-learning-task-1">A relational learning task</h3>
<ul>
<li>Given a large set of triples that come from some family trees, figure out the regularities.
<ul>
<li>The obvious way to express the regularities is as symbolic rules:<br>
<span class="math display">
HasMother(x,y)\ and\ HasHusband(y,z) \implies HasFather(x, z)
</span></li>
</ul></li>
<li>Finding the symbolic rules involves a difficult search through a very large discrete space of possibilities.<br>
</li>
<li>Can a neural network capture the same knowledge by searching through a continuous space of weights?</li>
</ul>
</section>
<section id="the-structure-of-the-neural-net-1" class="level3">
<h3 class="anchored" data-anchor-id="the-structure-of-the-neural-net-1">The structure of the neural net</h3>
<ul>
<li>The six hidden units in the bottleneck connected to the input representation of person 1 learn to represent features of people that are useful for predicting the answer.</li>
<li>Nationality, generation, branch of the family tree. These features are only useful if the other bottlenecks use similar representations and the central layer learns how features predict other features. For example: Input person is of generation 3 and relationship requires answer to be one generation up implies Output person is of generation 2 This video introduces distributed representations. It’s not actually about predicting words, but it’s building up to that. It does a great job of looking inside the brain of a neural network. That’s important, but not always easy to do.</li>
</ul>
</section>
</section>
<section id="lecture-4b-a-brief-diversion-into-cognitive-science" class="level2">
<h2 class="anchored" data-anchor-id="lecture-4b-a-brief-diversion-into-cognitive-science">Lecture 4b: A brief diversion into cognitive science</h2>
<p>This video is part of the course, i.e.&nbsp;it’s not optional, despite what Geoff says in the beginning of the video. This video gives a high-level interpretation of what’s going on in the family tree network. This video contrasts two types of inference:</p>
<ul>
<li>Conscious inference, based on relational knowledge.</li>
<li>Unconscious inference, based on distributed representations.</li>
</ul>
</section>
<section id="lecture-4c-another-diversion-the-softmax-output-function" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="lecture-4c-another-diversion-the-softmax-output-function">Lecture 4c: Another diversion: The Softmax output function</h2>
<p>A Softmax cost function is a general-purpose ML component/technique for combining binary discriminators into a probability distribution to construct a classifier We’ve seen binary threshold output neurons and logistic output neurons. This video presents a third type.</p>
<p>This one only makes sense if we have multiple output neurons.</p>
<section id="problems-with-squared-error" class="level3">
<h3 class="anchored" data-anchor-id="problems-with-squared-error">Problems with squared error</h3>
<ul>
<li>The squared error measure has some drawbacks:
<ul>
<li>If the desired output is 1 and the actual output is 0.00000001 there is almost no gradient for a logistic unit to fix up the error.</li>
<li>If we are trying to assign probabilities to mutually exclusive class labels, we know that the outputs should sum to 1, but we are depriving the network of this knowledge.</li>
</ul></li>
<li>Is there a different cost function that works better?
<ul>
<li>Yes: Force the outputs to represent a probability distribution across discrete alternatives</li>
</ul></li>
</ul>
</section>
<section id="softmax" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="softmax">Softmax</h3>
<p>The output units in a softmax group use a non-local non-linearity:</p>
<p><span class="math display">
y_i = \frac{e^{z_i}}{\sum_{j\in group} e^{z_i}}
</span></p>
<p><span class="math display">
\frac{\partial y_i}{\partial z_i} = y_i(1-y_i)
</span></p>

<div class="no-row-height column-margin column-container"><div class="">
<p><a href="softmax_0.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5"><img src="softmax_0.png" class="img-fluid"></a></p>
</div></div></section>
<section id="cross-entropy-the-right-cost-function-to-use-with-softmax" class="level3">
<h3 class="anchored" data-anchor-id="cross-entropy-the-right-cost-function-to-use-with-softmax">Cross-entropy: the right cost function to use with SoftMax</h3>
<p><span class="math display">
C=-\sum_j t_j \log y_i
</span> <span class="math display">
\frac {\partial C}{\partial z_i} = - \sum_j t_j \frac {\partial C}{\partial y_i} \frac {\partial y_u}{\partial z_i} = y_i -t_i
</span></p>
<ul>
<li>The right cost function is the negative log probability of the right answer.</li>
<li>C has a very big gradient when the target value is 1 and the output is almost zero.
<ul>
<li>A value of 0.000001 is much better than 0.000000001</li>
<li>The steepness of <span class="math inline">dC/dy</span> exactly balances the flatness of <span class="math inline">dy/dz</span></li>
</ul></li>
</ul>
<p>the cross entropy cost function - is the correct cost function to use with SoftMax</p>
<p>Architectural Note:</p>
<p>SoftMax unit +Cross-Entropy loss function =&gt; for classification</p>
</section>
</section>
<section id="lecture-4d-neuro-probabilistic-language-models" class="level2">
<h2 class="anchored" data-anchor-id="lecture-4d-neuro-probabilistic-language-models">Lecture 4d: Neuro-probabilistic language models</h2>
<p>This is the first of several applications of neural networks that we’ll studying in some detail, in this course.</p>
<p>Synonyms: word embedding; word feature vector; word encoding.</p>
<p>All of these describe the learned collection of numbers that is used to represent a word. “embedding” emphasizes that it’s a location in a high-dimensional space: it’s where the words are embedded in that space. When we check to see which words are close to each other, we’re thinking about that embedding.</p>
<p>“feature vector” emphasizes that it’s a vector instead of a scalar, and that it’s componential, i.e.&nbsp;composed of multiple feature values.</p>
<p>“encoding” is very generic and doesn’t emphasize anything specific. looks at the trigram model</p>
<section id="a-basic-problem-in-speech-recognition" class="level3">
<h3 class="anchored" data-anchor-id="a-basic-problem-in-speech-recognition">A basic problem in speech recognition</h3>
<ul>
<li>We cannot identify phonemes perfectly in noisy speech
<ul>
<li>The acoustic input is often ambiguous: there are several different words that fit the acoustic signal equally well.</li>
</ul></li>
<li>People use their understanding of the meaning of the utterance to hear the right words.
<ul>
<li>We do this unconsciously when we wreck a nice beach.</li>
<li>We are very good at it.</li>
</ul></li>
<li>This means speech recognizers have to know which words are likely to come next and which are not.
<ul>
<li>Fortunately, words can be predicted quite well without full understanding.</li>
</ul></li>
</ul>
</section>
<section id="the-standard-trigram-method" class="level3">
<h3 class="anchored" data-anchor-id="the-standard-trigram-method">The standard “trigram” method</h3>
<ul>
<li>Take a huge amount of text and count the frequencies of all triples of words.</li>
<li>Use these frequencies to make bets on the relative probabilities of words given the previous two words:</li>
</ul>
<p><span class="math display">
\frac{p(w_3=c|w_2=b,w_1=a)}{p(w_3=d|w_2=b,w_1=a)}=\frac{count(abc)}{count(abd)}
</span></p>
<ul>
<li>Until very recently this was the state-of-the-art.</li>
<li>We cannot use a much bigger context because there are too many possibilities to store and the counts would mostly be zero.</li>
<li>We have to “back-off” to digrams when the count for a trigram is too small.
<ul>
<li>The probability is not zero just because the count is zero!</li>
</ul></li>
</ul>
</section>
<section id="information-that-the-trigram-model-fails-to-use" class="level3">
<h3 class="anchored" data-anchor-id="information-that-the-trigram-model-fails-to-use">Information that the trigram model fails to use</h3>
<ul>
<li>Suppose we have seen the sentence “the cat got squashed in the garden on friday”</li>
<li>This should help us predict words in the sentence “the dog got flattened in the yard on monday”</li>
<li>A trigram model does not understand the similarities between
<ul>
<li>cat/dog squashed/flattened garden/yard friday/monday</li>
</ul></li>
<li>To overcome this limitation, we need to use the semantic and syntactic features of previous words to predict the features of the next word.
<ul>
<li>Using a feature representation also allows a context that contains many more previous words (e.g.&nbsp;10).</li>
</ul></li>
</ul>
</section>
</section>
<section id="lecture-4e-ways-to-deal-with-the-large-number-of-possible-outputs" class="level2">
<h2 class="anchored" data-anchor-id="lecture-4e-ways-to-deal-with-the-large-number-of-possible-outputs">Lecture 4e: Ways to deal with the large number of possible outputs</h2>
<p>When <strong>softmax</strong> is very big it becomes hard to train and store.</p>
<ol type="1">
<li>A serial architecture, based on trying candidate next words, using feature vectors (like in the family example). This means fewer parameters, but still a lot of work.</li>
<li>Using a binary tree.</li>
<li>Collobert &amp; Weston’s search for good feature vectors for words, without trying to predict the next word in a sentence.</li>
</ol>
</section>
<section id="bengios-neural-net-for-predicting-the-next-word" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="bengios-neural-net-for-predicting-the-next-word">Bengio’s neural net for predicting the next word</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="serial_architecture_1.png" class="lightbox" data-glightbox="description: .lightbox-desc-6" data-gallery="quarto-lightbox-gallery-6" title="A serial architecture"><img src="serial_architecture_1.png" class="img-fluid figure-img" alt="A serial architecture"></a></p>
<figcaption>A serial architecture</figcaption>
</figure>
</div>
<section id="a-serial-architecture" class="level3">
<h3 class="anchored" data-anchor-id="a-serial-architecture">A serial architecture</h3>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="serial_architecture_2.png" class="lightbox" data-glightbox="description: .lightbox-desc-7" data-gallery="quarto-lightbox-gallery-7" title="A serial architecture"><img src="serial_architecture_2.png" class="img-fluid figure-img" alt="A serial architecture"></a></p>
<figcaption>A serial architecture</figcaption>
</figure>
</div>
</section>
<section id="learning-in-the-serial-architecture" class="level3">
<h3 class="anchored" data-anchor-id="learning-in-the-serial-architecture">Learning in the serial architecture</h3>
<ul>
<li>After computing the logit score for each candidate word, use all of the logits in a softmax to get word probabilities.</li>
<li>The difference between the word probabilities and their target probabilities gives cross-entropy error derivatives.
<ul>
<li>The derivatives try to raise the score of the correct candidate and lower the scores of its high-scoring rivals.</li>
</ul></li>
<li>We can save a lot of time if we only use a small set of candidates suggested by some other kind of predictor.
<ul>
<li>For example, we could use the neural net to revise the probabilities of the words that the trigram model thinks are likely.</li>
</ul></li>
</ul>
</section>
<section id="learning-to-predict-the-next-word-by-predicting-a-path-through-a-tree" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="learning-to-predict-the-next-word-by-predicting-a-path-through-a-tree">Learning to predict the next word by predicting a path through a tree</h3>
<p>In <span class="citation" data-cites="mnih2009improving">Mnih, Yuecheng, and Hinton (<a href="#ref-mnih2009improving" role="doc-biblioref">2009</a>)</span> the authors show how to improve a state-of-the-art neural network language model that converts the previous “context” words into feature vectors and combines these feature vectors linearly to predict the feature vector of the next word.</p>
<p>Significant improvements in predictive accuracy are achieved by using a non-linear subnetwork to modulate the effects of the context words or to produce a non-linear correction term when predicting the feature vector.</p>

<div class="no-row-height column-margin column-container"><div class="">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="softmax_1.png" class="lightbox" data-glightbox="description: .lightbox-desc-8" data-gallery="quarto-lightbox-gallery-8" title="Softmax as a tree"><img src="softmax_1.png" class="img-fluid figure-img" alt="Softmax as a tree"></a></p>
<figcaption>Softmax as a tree</figcaption>
</figure>
</div>
</div></div><ul>
<li>Arrange all the words in a binary tree with words as the leaves.</li>
<li>Use the previous context to generate a <strong>prediction vector</strong>, <span class="math inline">v</span>.
<ul>
<li>Compare v with a learned vector, u, at each node of the tree.</li>
<li>Apply the logistic function to the scalar product of u and v to predict the probabilities of taking the two branches of the tree.</li>
</ul></li>
</ul>
</section>
<section id="a-picture-of-the-learning" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="a-picture-of-the-learning">A picture of the learning</h3>

<div class="no-row-height column-margin column-container"><div class="">
<p><img src="softmax_learning.png" class="img-fluid" alt="Softmax learning"> <img src="softmax_2.png" class="img-fluid" alt="Path in a tree Softmax"></p>
</div></div></section>
<section id="a-convenient-decomposition" class="level3">
<h3 class="anchored" data-anchor-id="a-convenient-decomposition">A convenient decomposition</h3>
<ul>
<li>Maximizing the log probability of picking the target word is equivalent to maximizing the sum of the log probabilities of taking all the branches on the path that leads to the target word.
<ul>
<li>So during learning, we only need to consider the nodes on the correct path. This is an exponential win: <mark><span class="math inline">log(N)</span> instead of <span class="math inline">N</span>.</mark></li>
<li>For each of these nodes, we know the correct branch and we know the current probability of taking it so we can get derivatives for learning both the prediction vector v and that node vector u.</li>
</ul></li>
<li><mark>Unfortunately, it is still slow at <strong>test time</strong>.</mark></li>
</ul>
</section>
</section>
<section id="a-simpler-way-to-learn-feature-vectors-for-words" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="a-simpler-way-to-learn-feature-vectors-for-words">A simpler way to learn feature vectors for words</h2>
<p>This method comes from the paper <span class="citation" data-cites="Collobert2008Unified">(<a href="#ref-Collobert2008Unified" role="doc-biblioref">Collobert and Weston 2008</a>)</span></p>

<div class="no-row-height column-margin column-container"><div class="">
<p><a href="Collobert_and_Weston.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9"><img src="Collobert_and_Weston.png" class="img-fluid"></a></p>
</div></div><section id="displaying-the-learned-feature-vectors-in-a-2-d-map" class="level3">
<h3 class="anchored" data-anchor-id="displaying-the-learned-feature-vectors-in-a-2-d-map">Displaying the learned feature vectors in a 2-D map</h3>
<ul>
<li>We can get an idea of the quality of the learned feature vectors by displaying them in a 2-D map.
<ul>
<li>Display very similar vectors very close to each other.</li>
<li>Use a multi-scale method called “t-sne” that also displays similar clusters near each other.</li>
</ul></li>
<li>The learned feature vectors capture lots of subtle semantic distinctions, just by looking at strings of words.
<ul>
<li>No extra supervision required.</li>
<li>The information is all in the contexts that the word is used in.</li>
<li>Consider “She <strong>scrommed</strong> him with the frying pan.”</li>
</ul></li>
</ul>
</section>
<section id="part-of-a-2-d-map-of-the-2500-most-common-words" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="part-of-a-2-d-map-of-the-2500-most-common-words">Part of a 2-D map of the 2500 most common words</h3>
<div class="page-columns page-full">
<p><img src="tsne_1.png" class="img-fluid" alt="tsne_output"> <img src="tsne_2.png" class="img-fluid" alt="tsne_output"></p>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p class="page-columns page-full"><a href="tsne_3.png" class="lightbox page-columns page-full" data-glightbox="description: .lightbox-desc-10" data-gallery="quarto-lightbox-gallery-10" title="tsne_output"><img src="tsne_3.png" class="img-fluid figure-img column-margin\" alt="tsne_output"></a></p>
<figcaption>tsne_output</figcaption>
</figure>
</div>
</div>


<div class="hidden" aria-hidden="true">
<span class="glightbox-desc lightbox-desc-1">relational information</span>
<span class="glightbox-desc lightbox-desc-2">structure of the neural net</span>
<span class="glightbox-desc lightbox-desc-3">visulization of 6 neuron weights</span>
<span class="glightbox-desc lightbox-desc-4">the relational data</span>
<span class="glightbox-desc lightbox-desc-6">A serial architecture</span>
<span class="glightbox-desc lightbox-desc-7">A serial architecture</span>
<span class="glightbox-desc lightbox-desc-8">Softmax as a tree</span>
<span class="glightbox-desc lightbox-desc-10">tsne_output</span>
</div>

</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-Collobert2008Unified" class="csl-entry" role="listitem">
Collobert, Ronan, and Jason Weston. 2008. <span>“A Unified Architecture for Natural Language Processing: Deep Neural Networks with Multitask Learning.”</span> In <em>Proceedings of the 25th International Conference on Machine Learning</em>, 160–67. ICML ’08. New York, NY, USA: Association for Computing Machinery. <a href="https://doi.org/10.1145/1390156.1390177">https://doi.org/10.1145/1390156.1390177</a>.
</div>
<div id="ref-mnih2009improving" class="csl-entry" role="listitem">
Mnih, Andriy, Zhang Yuecheng, and Geoffrey Hinton. 2009. <span>“Improving a Statistical Language Model Through Non-Linear Prediction.”</span> <em>Neurocomputing</em> 72 (7-9): 1414–18. https://doi.org/<a href="https://doi.org/10.1016/j.neucom.2008.12.025">https://doi.org/10.1016/j.neucom.2008.12.025</a>.
</div>
</div></section><section class="quarto-appendix-contents" id="quarto-reuse"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div class="quarto-appendix-contents"><div>CC SA BY-NC-ND</div></div></section><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{bochman2017,
  author = {Bochman, Oren},
  title = {Deep {Neural} {Networks} - {Notes} for {Lesson} 4},
  date = {2017-08-10},
  url = {https://orenbochman.github.io/blog//notes/dnn/dnn-04/l_04.html},
  langid = {en}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-bochman2017" class="csl-entry quarto-appendix-citeas" role="listitem">
Bochman, Oren. 2017. <span>“Deep Neural Networks - Notes for Lesson
4.”</span> August 10, 2017. <a href="https://orenbochman.github.io/blog//notes/dnn/dnn-04/l_04.html">https://orenbochman.github.io/blog//notes/dnn/dnn-04/l_04.html</a>.
</div></div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("^(?:http:|https:)\/\/www\.quarto\.org\/custom");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
          // default icon
          link.classList.add("external");
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
      for (let i=0; i<annoteTargets.length; i++) {
        const annoteTarget = annoteTargets[i];
        const targetCell = annoteTarget.getAttribute("data-target-cell");
        const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
        const contentFn = () => {
          const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          if (content) {
            const tipContent = content.cloneNode(true);
            tipContent.classList.add("code-annotation-tip-content");
            return tipContent.outerHTML;
          }
        }
        const config = {
          allowHTML: true,
          content: contentFn,
          onShow: (instance) => {
            selectCodeLines(instance.reference);
            instance.reference.classList.add('code-annotation-active');
            window.tippy.hideAll();
          },
          onHide: (instance) => {
            unselectCodeLines();
            instance.reference.classList.remove('code-annotation-active');
          },
          maxWidth: 300,
          delay: [50, 0],
          duration: [200, 0],
          offset: [5, 10],
          arrow: true,
          appendTo: function(el) {
            return el.parentElement.parentElement.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto',
          placement: 'right',
          popperOptions: {
            modifiers: [
            {
              name: 'flip',
              options: {
                flipVariations: false, // true by default
                allowedAutoPlacements: ['right'],
                fallbackPlacements: ['right', 'top', 'top-start', 'top-end', 'bottom', 'bottom-start', 'bottom-end', 'left'],
              },
            },
            {
              name: 'preventOverflow',
              options: {
                mainAxis: false,
                altAxis: false
              }
            }
            ]        
          }      
        };
        window.tippy(annoteTarget, config); 
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://utteranc.es/client.js" repo="OrenBochman/blogComments" issue-term="pathname" theme="github-light" crossorigin="anonymous" async="">
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
 Copyright 2024, Oren Bochman
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="../../../about.html">
<p>About</p>
</a>
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="../../../license.html">
<p>License</p>
</a>
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="../../../trademark.html">
<p>Trademark</p>
</a>
  </li>  
</ul>
    <div class="cookie-consent-footer"><a href="#" id="open_preferences_center">Cookie Preferences</a></div></div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>
<script>var lightboxQuarto = GLightbox({"descPosition":"bottom","closeEffect":"zoom","loop":false,"selector":".lightbox","openEffect":"zoom"});
window.onload = () => {
  lightboxQuarto.on('slide_before_load', (data) => {
    const { slideIndex, slideNode, slideConfig, player, trigger } = data;
    const href = trigger.getAttribute('href');
    if (href !== null) {
      const imgEl = window.document.querySelector(`a[href="${href}"] img`);
      if (imgEl !== null) {
        const srcAttr = imgEl.getAttribute("src");
        if (srcAttr && srcAttr.startsWith("data:")) {
          slideConfig.href = srcAttr;
        }
      }
    } 
  });

  lightboxQuarto.on('slide_after_load', (data) => {
    const { slideIndex, slideNode, slideConfig, player, trigger } = data;
    if (window.Quarto?.typesetMath) {
      window.Quarto.typesetMath(slideNode);
    }
  });

};
          </script>




<script src="../../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>