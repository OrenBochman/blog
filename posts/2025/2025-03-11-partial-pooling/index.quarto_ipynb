{
  "cells": [
    {
      "cell_type": "markdown",
      "metadata": {},
      "source": [
        "---\n",
        "date: 2025-03-11\n",
        "title: The roles of Partial pooling and mixed strategies in the Lewis signaling game\n",
        "subtitle: a game theoretic perspective\n",
        "categories: [emergent languages, lewis signaling game, game theory, complex signaling system]\n",
        "keywords: [signaling games, partial pooling, mixed strategies, Lewis signaling game]\n",
        "bibliography: ./bibliography.bib\n",
        "image: /images/cover.png\n",
        "---\n",
        "\n",
        "\n",
        "Today I posit a couple of questions on the Lewis signaling game. \n",
        "\n",
        "1. Are there useful^[for signaling agents] interpretation of some equilibria in the Lewis signaling game that are not fully separable equilibria?\n",
        "1. Are some partial pooling equilibria more useful than others?\n",
        "1. Might agents prefer to employ partial pooling strategies over fully separable equilibria?\n",
        "1. Might agents want to employ mixed strategies?\n",
        "\n",
        "## Partial Pooling\n",
        "\n",
        "let's imagine we have this signaling system\n"
      ],
      "id": "95ba2f63"
    },
    {
      "cell_type": "code",
      "metadata": {},
      "source": [
        "#| label: tbl-predators\n",
        "#| tbl-cap: predators and their signals\n",
        "\n",
        "from IPython.display import Markdown\n",
        "from tabulate import tabulate\n",
        "\n",
        "lexicon = {}\n",
        "\n",
        "lexicon['falcon']  = '000 00'\n",
        "lexicon['hawk']    = '000 01'\n",
        "lexicon['eagle']   = '000 10'\n",
        "lexicon['panther']     = '111 00'\n",
        "lexicon['leopard'] = '111 01'\n",
        "lexicon['jaguar'] =  '111 11'\n",
        "\n",
        "# converting the lexicon to a table\n",
        "table = [[k, v] for k, v in lexicon.items()]\n",
        "\n",
        "\n",
        "Markdown(tabulate(\n",
        "  table, \n",
        "  headers=[\"Pre-Linguistic- Object\", \"signal\"]\n",
        "))"
      ],
      "id": "tbl-predators",
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "metadata": {},
      "source": [
        "A spider monkey, the response for a raptor might be dealt with by descending from the top of trees to the second or third level of the canopy. A cat might be dealt with by moving to the top of the tree.\n",
        "\n",
        "Clearly though there is little time to waste. So the monkey should be moving with ataractic as soon as it hears either '000' or '111'. \n",
        "\n",
        "But '000' and '111' are not signals they are artifacts of the lexicon. Or are they?\n"
      ],
      "id": "80203999"
    },
    {
      "cell_type": "code",
      "metadata": {},
      "source": [
        "#| label: tbl-predators-categories\n",
        "#| tbl-cap: predators categories and their signals\n",
        "\n",
        "lexicon = {}\n",
        "\n",
        "lexicon['raptor']  = '000 '\n",
        "lexicon['hawk']    = '000 '\n",
        "lexicon['eagle']   = '000 '\n",
        "lexicon['raptor']  = '000 '\n",
        "\n",
        "lexicon['feline']  = '111'\n",
        "lexicon['panther'] = '111'\n",
        "lexicon['leopard'] = '111'\n",
        "lexicon['jaguar']  = '111'\n",
        "\n",
        "# converting the lexicon to a table\n",
        "table = [[k, v] for k, v in lexicon.items()]\n",
        "\n",
        "Markdown(tabulate(\n",
        "  table, \n",
        "  headers=[\"Pre-Linguistic- Object\", \"signal\"]\n",
        "))"
      ],
      "id": "tbl-predators-categories",
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "metadata": {},
      "source": [
        "This is only a partial pooling equilibrium.\n",
        "IT doesn't allow the monkeys to distinguish between the different types of raptors or felines.\n",
        "\n",
        "We care about it because it can serve the monkeys as a starting point for more complex signaling systems like the one above that are compatible with the semantics captured in this one - that there are two groups with two urgent actions. The has an implicit prefix that is compatible with the semantics of the category. The prefix arises in part from choice of using prefix codes inspired by Huffman codes [@Huffman1952Method]\n",
        "\n",
        "\n",
        "If all the monkeys care about is the up down response the partial pooling equilibrium is all they need to learn. If they have benefits at distinguishing between the different types of predators, when they are at a distance, they would need to learn a more complex signaling system.\n",
        "\n",
        "But when threat is imminent, the partial pooling equilibrium is \n",
        "what they should be using both as sender and as receiver.\n",
        "\n",
        "Also it is conceivable that a number of signaling systems compatible with #tbl-predators-categories might arrise by further spontaneous symmetry breaking once this equilibrium is established. with #tbl-predators being one such option.\n",
        "\n",
        "Now in most research on simple signaling system we often emphsize how signaing systems can arise  via spontaneous symmetry breaking. Suppose the monkey learn the following signaling system.\n"
      ],
      "id": "ef440c79"
    },
    {
      "cell_type": "code",
      "metadata": {},
      "source": [
        "#| label: tbl-predators-incompatible\n",
        "#| tbl-cap: predators and their signals 2\n",
        "\n",
        "from IPython.display import Markdown\n",
        "from tabulate import tabulate\n",
        "\n",
        "lexicon = {}\n",
        "\n",
        "lexicon['falcon']  = '000 00'\n",
        "lexicon['panther']    = '000 01'\n",
        "lexicon['eagle']   = '000 10'\n",
        "lexicon['hawk'] = '111 00'\n",
        "lexicon['leopard'] = '111 01'\n",
        "lexicon['jaguar']  = '111 11'\n",
        "\n",
        "# converting the lexicon to a table\n",
        "table = [[k, v] for k, v in lexicon.items()]\n",
        "\n",
        "\n",
        "Markdown(tabulate(\n",
        "  table, \n",
        "  headers=[\"Pre-Linguistic- Object\", \"signal\"]\n",
        "))"
      ],
      "id": "tbl-predators-incompatible",
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "metadata": {},
      "source": [
        "Here hawk and panther have been swapped. This system lacks the structure of the partial pooling equilibrium. The prefix no longer maps to the category.\n",
        "\n",
        "The spider monkeys in this case might exhibit reduced fitness as a group as they have to hear the full signal before they can respond. \n",
        "\n",
        "One way out is for them to use a mixed strategy. If they alternate between two systms they can get the benefits of both.\n",
        "\n",
        "The problem here is that in game theory we generaly consider such a strategy as 10% of one and 80% of the other and some randomiser picking between the two. Here we want the choice to be\n",
        "deterministic. Leaving aside the formal question we can see that \n",
        "on the path to learning a full signaling system agents may pass though many states in which they do not have a full signaling system and may be only equipped with partial pooling equilibria.\n",
        "\n",
        "Another view might be as follows:\n"
      ],
      "id": "28fd7646"
    },
    {
      "cell_type": "code",
      "metadata": {},
      "source": [
        "#| label: tbl-predators-partial\n",
        "#| tbl-cap: predators and their signals 3\n",
        "\n",
        "from IPython.display import Markdown\n",
        "from tabulate import tabulate\n",
        "\n",
        "lexicon = {}\n",
        "\n",
        "lexicon['falcon']  = '000 00'\n",
        "lexicon['jaguar']    = '111 00'\n",
        "\n",
        "\n",
        "# converting the lexicon to a table\n",
        "table = [[k, v] for k, v in lexicon.items()]\n",
        "\n",
        "\n",
        "Markdown(tabulate(\n",
        "  table, \n",
        "  headers=[\"Pre-Linguistic- Object\", \"signal\"]\n",
        "))"
      ],
      "id": "tbl-predators-partial",
      "execution_count": null,
      "outputs": []
    },
    {
      "cell_type": "markdown",
      "metadata": {},
      "source": [
        "This suggest a new insight into complex signaling systems. Hierarchies can learned early\n",
        "\n",
        "\n",
        "\n",
        "## Quick Brain dump\n",
        "\n",
        "as time is short here are a bunch of points for further exploration\n",
        "\n",
        "1. the partial pooling equilibrium correspond to subsets of bayesian senders.\n",
        "1. we show a category but we mean full hierarchies of categories. These are a preorder and thus imply a topological structure on the state space. This is  the Alexandrov Topology (Topology from a Preorder)\n",
        "1. we can learn hierarchies of categories by learning an representative. But learning a representative for each category is also the basis of a clarifier. A classifier is also a type of decision we want to cary out on states to determine the action we should take. In this sense we are talking about a process for rough to fine specification of semantics.\n",
        "1. Each hierarchy of categories represents a **semantic symmetry**. Members share a rough semantic meaning but differ in the fine details.\n",
        "1. We might also repurpose this idea for other symmetries like morpgology and phonology.\n",
        "1. If each category is imbued with a prefix we end up with many prefixes corresponding to atoms of discourse. If there are not too many we might build words from these prefixes.\n",
        "1. as there is an increased fitness for languages with prefix and at least certain hierarchies of categories we can see that this may be a desiderata for the evolution of signaling systems. More so we might want an RL algorithm to step between a lattice of such partial pooling equilibria rather then learning by spontaneous symmetry breaking. \n",
        "1. This is planning of hierarchies of categories. However in reality we inherit the hierarchies from the state space of from the prelinguistic objects.\n",
        "1. another form of using mixed strategies is code switching - where we switch between partial pooling equilibria - each learned for a specific sender. At certain points such a code swithing reciever might become promoted to a sender and use the inforamtion in the partial pooling equilibria to infer/plan a full langauge from the differnt langauges it ha learned. This is a form of transfer learning. The result might be a pidgin or a creole depending if the reciever uses a lexicon or a linear function approximat which is a generelization of a lexicon!\n",
        "1. In my experience in NLP categories are not encoded as a prefix. In fact they are only encoded in a very limited fashion using a suffix like great, greater, greatest. Numbers do tend to have a base 10 encoding but not as clean as a prefix code. Langauges do have many hierarchies encoded into thesauri and wordnets. I think that at some level (e.g. semantic roles labeling) and phrase structure hierarchies can shape langauges evolution. \n",
        "1. Why is this type of hierarchies absent from the lexicon of natural Languages?\n",
        "1. The quest for a perfectly regular interlingua might be shaped by an algorithm that learn to encode thesauri like hierarchies down into the phonetic stratum and via algorithms that jump between partial pooling equilibria. ^[A language with rich yet fully pooling morphology and a thesaurus-like-lexicon]\n",
        "1. Another point I did not raise is that there are lots more partial equilibria than fully separating equilibria. This suggest that it should be easy for a language 'planner' to find nearly compatible partial pooling equilibria with an existing language.\n",
        "By switching around the incompatibilities the language can then gain a new categorical prefix and be easier to learn as well as require less processing going forward."
      ],
      "id": "02941576"
    }
  ],
  "metadata": {
    "kernelspec": {
      "name": "python3",
      "language": "python",
      "display_name": "Python 3 (ipykernel)",
      "path": "/home/oren/.local/share/jupyter/kernels/python3"
    }
  },
  "nbformat": 4,
  "nbformat_minor": 5
}