---
title: "Lessons learnt in optimizing a large-scale pandas application using Polars, FireDucks and cuDF: Go Smart and Save More!"
subtitle: "PyData Global 2025 Recap"
date: 2025-12-09
categories: ["PyData", "Pandas", "Data Science", "Performance Optimization", "Polars", "cuDF", "FireDucks"]
keywords: ["PyData", "Pandas", "Data Science", "Performance Optimization", "Polars", "cuDF", "FireDucks"]
description: "A detailed exploration of optimizing large-scale pandas applications using high-performance alternatives like Polars, FireDucks, and cuDF, highlighting best practices and performance improvements."
image: pydata_logo.png
---

![pydata global](pydata_logo.png){.column-margin}


::: {.callout-tip}
## Lecture Overview

In general, a Data Scientist spends significant efforts in transforming the raw data into a more digestible format before training an AI model or creating visualisations. Traditional tools such as pandas have long been the linchpin in this process, offering powerful capabilities but not without limitations. With numerous possible ways to write the same thing in pandas, often a user ends up selecting the uneconomical, inefficient ones, leading to large computational　costs　with the growth in data size. We introduce a couple of frequently occurring　intricate performance issues in pandas, and what we have learnt in solving the same using popular high-performance pandas alternatives: Polars, FireDucks and cuDF. The talk intends to highlight one of the best practices (breaking out of the loops) that one should follow while dealing with large-scale data analysis, while demonstrating the key advantages of the high-performance pandas alternatives based on different scenarios.
:::


::: {.callout-tip}
## What You'll Learn:
- How the choice and execution order of API calls in writing an data-related application impacts its performance.
- How to stop thinking the loop-based approach and design the algorithms using DataFrame APIs.
- How the internal query optimizers in libraries like Polars, FireDucks etc, can be useful to bring SQL-like optimizations at python-level.
- Whether to pay a large migration cost for optimizing an existing pandas-based application or to go smart with some minor modifications and save more operational cost.
:::


::: {.callout-tip}
## Prerequisites:

- Basic Python and PyTorch
- Some familiarity with neural networks (e.g., feedforward, softmax)
- No need for prior experience in building models from scratch
:::

## Tools and Frameworks:

We will introduce you to certain modern frameworks in the workshop but the emphasis be on first principles and using vanilla Python and LLM calls to build AI-powered systems.


[workshop repo](https://github.com/hugobowne/AI-for-SWEs)


:::: {.callout-tip}
## Speakers: 

### Sourav Saha

> Sourav has 12+ years of professional experience at NEC Corporation in the diverse fields of High-Performance Computing, Distributed Programming, Compiler Design, and Data Science. Currently, his team at NEC R&D Lab, Japan, is researching various data processing-related algorithms. Blending the mixture of different niche technologies related to compiler framework, high-performance computing, and multi-threaded programming, they have developed a Python library named FireDucks with highly compatible pandas APIs for DataFrame-related operations. In his previous engagements, he has worked in research and development of performance-critical AI and Big Data solutions, optimization of several legacy applications related to weather prediction, earth-quake simulation, etc., written in C++ and Fortran. He has been speaking at several meetups and technical conferences related to HPC and Data Science.
:::

[repo](https://github.com/qsourav/pydata-global-2025)

## Outline 

![Title](slide01.png)

![Quick Introduction!](slide02.png)

![Who is this talk for?](slide03.png)

![Overview of the Application](slide04.png)

![Pandas](slide05.png)

![Exploring High-performance Pandas Alternatives](slide06.png)

![Comparison among Chosen Libraries](slide07.png)

![Bottleneck Analysis](slide08.png)

![Bottleneck Analysis](slide09.png)

![Exploring Type-1 Bottlenecks (Loop-based implementation)](slide10.png)

![Query 01 Problem Statement](slide11.png)

- Fill missing values of “Description” column using the most frequent description of the specific “StockCode”.

![Query 01: Implementation using iterrows](slide12.png)

![Query 01: Implementation using vectorized APIs](slide13.png)

![Query 02: Problem Statement](slide14.png)

Find the number of transactions a user performed within the N days (e.g., 90) of the current transaction

![Query 02: implementation using row-wise apply](slide15.png)

![Query 02: implementation using merge+filter](slide16.png)

![Query 03: Problem Statement](slide17.png)

- Calculate  total sales per Invoice for each Customer

![Query 03: apply-based vs vectorized implementation](slide18.png)

![Exploring Type-2 Bottlenecks (Vectorized implementation without optimized data flow)](slide19.png)

![Query 04: Problem Statement](slide20.png)

![Query 04: Vectorized implementation (unoptimized data flow)](slide21.png)

![Query 04: Vectorized implementation (optimized data flow)](slide22.png)

![Exploring Type-3 Bottlenecks (Vectorized implementation with optimized data flow)](slide23.png)

![Query 05: Problem Statement](slide24.png)

![Query 05: Vectorized implementation (optimized data flow)](slide25.png)

![Learning Summary](slide26.png)

![Learning #1: Breaking out of the loop](slide27.png)

![Learning #2: Single-node processing might be enough](slide28.png)

![Learning #3: FireDucks might be the one you are looking for!](slide29.png)

![Thank you](slide30.png)

https://github.com/qsourav/PyData-Global-2025

