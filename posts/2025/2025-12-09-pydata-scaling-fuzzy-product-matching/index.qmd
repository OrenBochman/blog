---
title: "Scaling Fuzzy Product Matching with BM25: A Comparative Study of Python and Database Solutions"
subtitle: "PyData Global 2025 Recap"
date: 2025-12-09
categories: ["PyData", "Fuzzy Matching", "BM25", "Data Integration", "Python", "DuckDB"]
keywords: ["PyData", "Fuzzy Matching", "BM25", "Data Integration", "Python", "DuckDB"]
description: "A practical guide to implementing BM25 for fuzzy product matching at scale using Python and DuckDB, complete with performance benchmarks and optimization tips."
image: pydata_logo.png
---

![pydata global](pydata_logo.png){.column-margin}

::: {.callout-tip}
## Lecture Overview

Tired of exact matches failing on messy data? This talk showcases how BM25, a powerful fuzzy search algorithm, tackles the challenge of enriching massive datasets with noisy product names. We'll compare practical, large-scale implementations using Python's bm25s library (accelerated by GPUs) and DuckDB's built-in full-text search. Join us to learn how to achieve fast, accurate data integration and discover the optimal tools for your fuzzy matching needs.
:::

## The problem at hand:

Are you constantly battling messy, inconsistent product names across massive datasets? Traditional exact matching just doesn't cut it when you're trying to integrate data from various sources (like a 1-million-row internal catalog with a 3.8-million-row external one like Open Food Facts). This talk addresses that exact problem: how to efficiently and accurately find fuzzy matches, saving you countless hours of manual reconciliation and enabling robust data enrichment. It's crucial for anyone working with real-world, imperfect data at scale.

## Is this talk for me?

This talk is for data engineers, data scientists, and analytics professionals who work with large-scale datasets and face challenges with data integration, record linkage, or building robust search functionalities. A basic understanding of dataframes and SQL will be helpful, but no deep prior knowledge of search algorithms is required.

This will be an informative and practical talk with a clear focus on real-world application. While we'll briefly cover the "why" behind BM25, the emphasis will be on "how" to implement and optimize it. We'll present concrete benchmarks and code examples, moving beyond theoretical concepts.

::: {.callout-tip}
## What You'll Learn:
- Understand why BM25 is a superior choice for fuzzy matching noisy product names compared to traditional methods.
- See a practical, head-to-head comparison of implementing BM25 using Python libraries (specifically the optimized Cython bm25s) and DuckDB's native full-text search.
- Gain insights into performance implications (speed and memory usage) for each approach on large datasets, including the benefits of GPU acceleration with Dask CuDF.
- Learn production tips for persisting indexes, handling bulk queries, and managing memory effectively.
- Be equipped to choose the most suitable BM25 implementation for your specific data enrichment and fuzzy matching needs, allowing you to build faster and more accurate data pipelines.
:::


::: {.callout-tip}
## Prerequisites:

- A medium level background in python
- An introductory level information about DuckDB
- An introductory level information into how BM25 works would be bonus!
:::

::: {.callout-important}
## Tools and Frameworks:

- [bm25s](https://pypi.org/project/bm25s/) - Fast BM25 implementation in Cython 
- [cuDF](https://docs.rapids.ai/api/cudf/stable/) - GPU DataFrames for Python
- [Dask](https://dask.org/) - Parallel computing with task scheduling
- [DuckDB](https://duckdb.org/) = In-process SQL OLAP Database Management System
:::

[workshop repo](https://github.com/hugobowne/AI-for-SWEs)


:::: {.callout-tip}
## Speakers: 

### Aniket Abhay Kulkarni

Aniket is an engineer at heart. He has founded [Curlscape](https://curlscape.com), where he helps businesses bring practical AI applications to life fast. He has led the design and deployment of large-scale systems across industries, from finance and healthcare to education and logistics. His work spans LLM-based information extraction, agentic workflows, voice assistants, and continuous evaluation frameworks.
:::


## Outline

![Title](slide01.png)

![About the speaker](slide02.png)

![The Data Challenge](slide05.png)

![Back of the Envelope: The M x N Problem](slide06.png)

![The Messy reality of Product Names](slide08.png)

![Enter BM25: The Search Engine Secret](slide10.png)

![The BM_{25} Formula](slide11.png)

$$
BM_{25}(q, d) = \sum_{i=1}^{n} IDF(q_i) \cdot \frac{f(q_i, d) \cdot (k_1 + 1)}{f(q_i, d) + k_1 \cdot (1 - b + b \cdot \frac{|d|}{avgdl})}
$$

![$bm_{25}$'s ranking - the Native approach](slide12.png)

![DuckDB the SQL Approach](slide13.png)

![$bm_{25}$'s Eager Sparse Scoreing](slide14.png)

![deep DiveL why is $bm_{25}$ so fast](slide15.png)

![Dashboard](slide16.png)

![Watching it work](slide17.png)

![Search was only half the problem](slide18.png)

![Dask +cuDF: GPU Accelerated Enrichment](slide19.png)

![The Complete Pipeline](slide20.png)

![Performance Summary](slide21.png)

![What we Learned](slide22.png)



